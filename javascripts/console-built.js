/*

  The MIT License (MIT)

  Copyright (c) 2007-2013 Einar Lielmanis and contributors.

  Permission is hereby granted, free of charge, to any person
  obtaining a copy of this software and associated documentation files
  (the "Software"), to deal in the Software without restriction,
  including without limitation the rights to use, copy, modify, merge,
  publish, distribute, sublicense, and/or sell copies of the Software,
  and to permit persons to whom the Software is furnished to do so,
  subject to the following conditions:

  The above copyright notice and this permission notice shall be
  included in all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
  NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS
  BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN
  ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN
  CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
  SOFTWARE.

 JS Beautifier
---------------


  Written by Einar Lielmanis, <einar@jsbeautifier.org>
      http://jsbeautifier.org/

  Originally converted to javascript by Vital, <vital76@gmail.com>
  "End braces on own line" added by Chris J. Shull, <chrisjshull@gmail.com>
  Parsing improvements for brace-less statements by Liam Newman <bitwiseman@gmail.com>


  Usage:
    js_beautify(js_source_text);
    js_beautify(js_source_text, options);

  The options are:
    indent_size (default 4)          - indentation size,
    indent_char (default space)      - character to indent with,
    preserve_newlines (default true) - whether existing line breaks should be preserved,
    max_preserve_newlines (default unlimited) - maximum number of line breaks to be preserved in one chunk,

    jslint_happy (default false) - if true, then jslint-stricter mode is enforced.

            jslint_happy   !jslint_happy
            ---------------------------------
             function ()      function()

    brace_style (default "collapse") - "collapse" | "expand" | "end-expand"
            put braces on the same line as control statements (default), or put braces on own line (Allman / ANSI style), or just put end braces on own line.

    space_before_conditional (default true) - should the space before conditional statement be added, "if(true)" vs "if (true)",

    unescape_strings (default false) - should printable characters in strings encoded in \xNN notation be unescaped, "example" vs "\x65\x78\x61\x6d\x70\x6c\x65"

    wrap_line_length (default unlimited) - lines should wrap at next opportunity after this number of characters.
          NOTE: This is not a hard limit. Lines will continue until a point where a newline would
                be preserved if it were present.

    e.g

    js_beautify(js_source_text, {
      'indent_size': 1,
      'indent_char': '\t'
    });

*/

// if (a) if (b) if(c) d(); else e(); else f();

define("nu-stream/stream",["require","exports"],function(e,t){var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=Function.prototype.call.bind(Array.prototype.reduce),L=function(e){return function(){return e}},A=function(e){return function(t,n){return e(n,t)}},O=function(e){var t;return function(){var n=arguments;return t===undefined&&(t=e.apply(undefined,n)),t}};n=null,r=n,i=function(e,t){return{first:e,rest:t}},s=function(e,t){return i(e,O(t))},c=function(e){return e.first},h=function(e){return e.rest(c(e))},p=function(e){return e===n},d=function(e){return e&&e.hasOwnProperty("first")&&e.hasOwnProperty("rest")||e===n},o=function(e,t){return i(e,L(t))},a=function(e,t){return p(e)?t():s(c(e),a.bind(null,h(e),t))};var M=function(e,t){return a(e,L(t))};u=function(){var e=arguments;return k(e,M,n)},f=function(e){return p(e)?e:a(c(e),f.bind(null,h(e)))};var _=function(e,t,r){return t>=r?n:s(e[t],_.bind(null,e,t+1,r))};l=function(e){var t=e.length;return _(e,0,t)},S=function(e,t){return p(e)||p(t)?n:s([c(e),c(t)],S.bind(null,h(e),h(t)))};var D=function(e){return i(e,function(e,t){return function(n){return e(t(n))}}(D,function(e,t){return e+t}.bind(null,1)))};x=S.bind(null,D(0)),v=function(e,t){for(var n=t;!p(n);n=h(n))e(c(n))},g=function(e,t,n){var r=t;return v(function(t){r=e(r,t)},n),r},m=g.bind(null,A(o),n),y=function(e,t,n){return g(e,t,m(n))},b=function(e,t){return g(e,c(t),h(t))},w=function(e,t){return b(e,m(t))};var P=function(e,t){return e.push(t),e};E=function(e){return g(P,[],e)},T=function(e,t){return p(t)?t:s(e(c(t)),T.bind(null,e,h(t)))},N=function(e,t){var n=t;for(;!p(n);n=h(n)){var r=c(n);if(e(r))return s(r,N.bind(null,e,h(n)))}return n},C=function(e,t){return function(){return e(t.apply(null,arguments))}}(f,T),t.end=n,t.NIL=r,t.stream=i,t.memoStream=s,t.cons=o,t.append=u,t.appendz=a,t.concat=f,t.from=l,t.first=c,t.rest=h,t.isEmpty=p,t.isStream=d,t.forEach=v,t.reverse=m,t.foldl=g,t.foldr=y,t.reduce=b,t.reduceRight=w,t.toArray=E,t.zip=S,t.indexed=x,t.map=T,t.filter=N,t.bind=C}),define("seshet",["require","exports"],function(e,t){var n,r,i,s,o=function(e,t){return e>t?e:t},u=function(e){return e?1+e.height:0},a=function(e){return e?o(u(e.left),u(e.right)):0},f=function(e){return e?u(e.left)-u(e.right):0},l=function(e,t,n){this.id=e,this.val=t,this.delegate=n};l.lookup=function(e,t,n){for(var r=e;r;r=r.delegate)if(t(r.id,n))return r.val;return null};var c=function(e,t,n,r,i){this.key=e,this.cell=t,this.left=n,this.right=r,this.height=i};c.setChildren=function(e,t,n){return new c(e.key,e.cell,t,n,t||n?1+o(a(t),a(n)):0)},c.setLeft=function(e,t){return c.setChildren(e,t,e.right)},c.setRight=function(e,t){return c.setChildren(e,e.left,t)},c.lookup=function(e,t,n,r,i){for(var s=e;s;){var o=t(r,s.key);if(o===0)return l.lookup(s.cell,n,i);s=o<0?s.left:s.right}return null},c.put=function(e,t,n){return new c(e.key,new l(t,n,e.cell),e.left,e.right,e.height)};var h=function(e){return e?c.setLeft(e.right,c.setRight(e,e.right.left)):e},p=function(e){return e?c.setRight(e.left,c.setLeft(e,e.left.right)):e},d=function(e){return p(c.setLeft(e,h(e.left)))},v=function(e){return h(c.setRight(e,p(e.right)))},m=function(e){var t=f(e);return t>1?f(e.left)<=-1?d(e):p(e):t<-1?f(e.right)>=1?v(e):h(e):e};c.update=function(e,t,n,r,i){if(!e)return new c(n,new l(r,i,null),null,null,0);var s=t(n,e.key);return s===0?c.put(e,r,i):m(s<0?c.setLeft(e,c.update(e.left,t,n,r,i)):c.setRight(e,c.update(e.right,t,n,r,i)))},c.rebalance=function(e){return Math.abs(f(e))<=1?e:m(c.setChildren(e,c.rebalance(e.left),c.rebalance(e.right)))},c.prune=function(e,t,n,r){if(!e)return e;if(n!==undefined){var i=t(e.key,n);if(i<0)return c.prune(e.right,t,n,r);if(i===0)return c.setChildren(e,null,c.prune(e.right,t,undefined,r))}return r!==undefined&&t(e.key,r)>=0?c.prune(e.left,t,n,r):c.setChildren(e,c.prune(e.left,t,n,r),c.prune(e.right,t,n,r))};var g=function(e,t,n){this.compare=e,this.eq=t,this.root=n};g.setRoot=function(e,t){return new g(e.compare,e.eq,t)},n=function(){var e=function(e,t){return e===t};return function(t,n){return new g(t,n||e,null)}}.call(this),r=function(e,t,n){return c.lookup(e.root,e.compare,e.eq,t,n)},i=function(e,t,n,r){return g.setRoot(e,c.update(e.root,e.compare,t,n,r))},s=function(e,t,n){return g.setRoot(e,c.rebalance(c.prune(e.root,e.compare,t,n)))},t.create=n,t.lookup=r,t.update=i,t.prune=s}),define("bennu/parse",["require","exports","nu-stream/stream","seshet"],function(e,t,n,r){var i=n.NIL,s=n.first,o=n.isEmpty,u=n.rest,a=n.foldl,f=n.reduceRight,l=n.foldr,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St=Function.prototype.call.bind(Array.prototype.map),xt=function(e){return e},Tt=function(){var e=arguments;return e},Nt=function(e){return function(){return e}},Ct=function(e){return function(){throw e}},kt=function(e){return function(t,n){return e(n,t)}};c=function(e,t,n,r,i,s,o){var u=this;u.p=e,u.state=t,u.m=n,u.cok=r,u.cerr=i,u.eok=s,u.eerr=o},h=function(e){var t=e;while(t instanceof c)t=t.p(t.state,t.m,t.cok,t.cerr,t.eok,t.eerr);return t},ct=function(e,t){var n=this;n.memoer=e,n.frames=t},ct.empty=new ct(r.create(function(e,t){return e.compare(t)},function(e,t){return e.id===t.id&&(e.state===t.state||e.state&&e.state.eq(t.state))}),[]),ct.pushWindow=function(e,t){return new ct(e.memoer,[t].concat(e.frames))},ct.popWindow=function(e){var t=e.frames;return new ct(t.length===1?r.prune(e.memoer,t[0]):e.memoer,t.slice(1))},ct.prune=function(e,t){return e.frames.length?e:new ct(r.prune(e.memoer,t),e.frames)},ct.lookup=function(e,t,n){return r.lookup(e.memoer,t,n)},ct.update=function(e,t,n,i){return new ct(r.update(e.memoer,t,n,i),e.frames)},w=function(e){var t=this;t.index=e},w.initial=new w(0),w.prototype.toString=function(){var e=this;return""+e.index},w.prototype.increment=function(e){var t=this;return new w(t.index+1)},w.prototype.compare=function(e){var t=this;return t.index-e.index},b=function(e,t,n){var r=this;r.input=e,r.position=t,r.userState=n},b.prototype.eq=function(e){var t=this;return e&&t.input===e.input&&t.userState===e.userState},b.prototype.isEmpty=function(){var e=this;return o(e.input)},b.prototype.first=function(){var e=this;return s(e.input)},b.prototype.next=function(e){var t=this;if(!t._next){var n=new b(u(t.input),t.position.increment(e),t.userState);t._next=function(t,r,i){return i(e,n,r)}}return t._next},b.prototype.setInput=function(e){var t=this;return new b(e,t.position,t.userState)},b.prototype.setPosition=function(e){var t=this;return new b(t.input,e,t.userState)},b.prototype.setUserState=function(e){var t=this;return new b(t.input,t.position,e)},p=function(e){var t=this;t.message=e},p.prototype=new Error,p.prototype.constructor=p,p.prototype.name="ParserError",d=function(e,t){var n=this;n.position=e,n._msg=t},d.prototype=new Error,d.prototype.constructor=d,d.prototype.name="ParseError",d.prototype.toString=function(){var e=this;return e.name+": "+e.message},Object.defineProperties(d.prototype,{message:{configurable:!0,get:function(){var e=this;return"At position:"+e.position+" "+e.errorMessage}},errorMessage:{configurable:!0,get:function(){var e=this;return e._msg===undefined?"":e._msg}}}),v=function(e,t){var n=this;d.call(n,e),n.errors=t||[]},v.prototype=new d,v.prototype.constructor=v,v.prototype.name="MultipleError",Object.defineProperty(v.prototype,"errorMessage",{get:function(){var e=this;return"["+St(e.errors,function(e){return e.message}).join(", ")+"]"}});var Lt=function(e,t,n){var r=this;d.call(r,e),r._pErr=t,r._qErr=n};Lt.prototype=new v,Lt.prototype.constructor=v,Lt.prototype.name="ChoiceError",Object.defineProperty(Lt.prototype,"errors",{get:function(){var e=this;return[e._pErr].concat(e._qErr.errors)}}),m=function(e){var t=this;d.call(t,e)},m.prototype=new d,m.prototype.constructor=m,m.prototype.name="UnknownError",Object.defineProperty(m.prototype,"errorMessage",{value:"unknown error"}),g=function(e,t){var n=this;d.call(n,e),n.unexpected=t},g.prototype=new d,g.prototype.constructor=g,g.prototype.name="UnexpectError",Object.defineProperty(g.prototype,"errorMessage",{get:function(){var e=this;return"Unexpected:"+e.unexpected}}),y=function(e,t,n){var r=this;d.call(r,e),r.expected=t,r.found=n},y.prototype=new d,y.prototype.constructor=y,y.prototype.name="ExpectError",Object.defineProperty(y.prototype,"errorMessage",{get:function(){var e=this;return"Expected:"+e.expected+(e.found?" Found:"+e.found:"")}}),E=function(e){var t=e(function(){var e=arguments;return t.apply(undefined,e)});return t},S=function(e,t){return t.hasOwnProperty("displayName")?S(e,function(){var e=arguments;return t.apply(undefined,e)}):Object.defineProperty(t,"displayName",{value:e,writable:!1})},x=function(e,t){return S(e,E(t))},T=function(e){return function(n,r,i,s,o,u){return o(e,n,r)}},N=function(e){return function(n,r,i,s,o,u){return u(e,n,r)}},C=function(e,t){return function(r,i,s,o,u,a){return new c(e,r,i,function(e,n,r){return new c(t(e),n,r,s,o,s,o)},o,function(e,n,r){return new c(t(e),n,r,s,o,u,a)},a)}},M=function(e){return function(n,r,i,s,o,u){var a=e(n);return o(a,a,r)}},A=S("Get Parser State",M(xt)),O=function(e){return M(Nt(e))},L=function(e){return function(n,r,i,s,o,u){return o(e(n),n,r)}},P=function(e){return M(function(t){return t.setUserState(e(t.userState))})},_=S("Get State",L(function(e){return e.userState})),D=function(e){return P(Nt(e))},j=S("Get Position",L(function(e){return e.position})),F=function(e){return M(function(t){return t.setPosition(e)})},H=S("Get Input",L(function(e){return e.input})),B=function(e){return M(function(t){return t.setInput(e)})};var At=function(e,t,n){return C(e,function(e){return C(t,function(t){return n(e,t)})})},Ot=function(e){return C(j,function(t){return N(e(t))})};I=function(e){var t=e?d:m;return Ot(function(n){return new t(n,e)})},k=S("EOF",function(){var e=T(i);return C(A,function(t){return t.isEmpty()?e:Ot(function(e){return new y(e,"end of input",t.first())})})}.call(this)),q=function(e){return function(n,r,i,s,o,u){var a=function(e,t,n){return u(e,t,ct.popWindow(n))};return new c(e,n,ct.pushWindow(r,n.position),function(e,t,n){return i(e,t,ct.popWindow(n))},a,function(e,t,n){return o(e,t,ct.popWindow(n))},a)}};var Mt=function(e){return function(n,r,i,s,o,u){return new c(e,n,r,o,s,o,u)}};R=function(e){return Mt(C(A,function(t){return C(e,function(e){return z(O(t),T(e))})}))},U=function(e){return Mt(At(H,j,function(t,n){return C(e,function(e){return V(F(n),B(t),T(e))})}))},z=function(e,t){return C(e,Nt(t))},W=f.bind(null,kt(z)),X=function(e,t){return function(n){return e(t(n))}}(W,n.from),V=function(e,t){return function(){return e(t.apply(null,arguments))}}(X,Tt);var _t=function(e){return function(t,n){return function(i,s,o,u,a,f){var l=i.position,h=function(t,r,s){var h=function(n,r,s){return f(e(l,t,n),i,s)};return new c(n,i,s,o,u,a,h)};return new c(t,i,s,o,u,a,h)}}};$=_t(function(e,t,n){return new v(e,[t,n])}),J=l.bind(null,kt(_t(function(e,t,n){return new Lt(e,t,n)})),C(j,function(e){return N(new v(e,[]))})),K=function(e,t){return function(n){return e(t(n))}}(J,n.from),Q=function(e,t){return function(){return e(t.apply(null,arguments))}}(K,Tt),G=function(e,t){return $(t,T(e))},Y=function(e,t){return function(r,i,s,o,u,a){return t(r,i,s,o,u,function(t,n,r){return a(new y(n.position,e),n,r)})}};var Dt=T(i),Pt=G.bind(null,i),Ht=function(e){return function(t,n){return C(t,function(t){return C(n,function(n){return T(e(t,n))})})}},Bt=function(e){return T(n.toArray(e))};Z=function(e){return C(e,Bt)},et=function(e,t){return C(Z(e),function(e){return t.apply(undefined,e)})},tt=Ht(n.cons),nt=Ht(n.append),rt=l.bind(null,kt(tt),Dt),it=function(e,t){return function(n){return e(t(n))}}(rt,n.from),st=function(e,t){return function(){return e(t.apply(null,arguments))}}(it,Tt);var jt=Ct(new p("Many parser applied to a parser that accepts an empty string"));ot=function(e){var t=function(t,n,r,i,s,o){return new c(e,t,n,r,i,jt,o)};return E(function(e){return Pt(tt(t,e))})},ut=function(e){return tt(e,ot(e))};var Ft=function(e,t){return new g(e,t===null?"end of input":t)};at=function(e,t){var n=t||Ft;return function(r,i,s,o,u,a){var f=r.position;if(r.isEmpty())return a(n(f,null),r,i);var l=r.first();if(e(l)){var h=function(e,t,n){var r=t.position;return s(e,t,ct.prune(n,r))};return new c(r.next(l),r,i,h,o,h,o)}return a(n(f,l),r,i)}},ft=S("Any Token",at(Nt(!0))),lt=function(e){return function(t,n,r,i,s,o){var u=t.position,a={id:e,state:t},f=ct.lookup(n,u,a);if(f)switch(f[0]){case"cok":return r(f[1],f[2],n);case"ceerr":return i(f[1],f[2],n);case"eok":return s(f[1],f[2],n);case"eerr":return o(f[1],f[2],n)}return new c(e,t,n,function(e,t,n){return r(e,t,ct.update(n,u,a,["cok",e,t]))},function(e,t,n){return i(e,t,ct.update(n,u,a,["cerr",e,t]))},function(e,t,n){return s(e,t,ct.update(n,u,a,["eok",e,t]))},function(e,t,n){return o(e,t,ct.update(n,u,a,["eerr",e,t]))})}},ht=function(e,t,n,r,i,s,o){return h(e(t,n,r,i,s,o))},pt=function(e,t,n,r){return ht(e,t,ct.empty,n,r,n,r)},dt=function(e,t,n,r,i){return pt(e,new b(t,w.initial,n),r,i)},vt=function(e,t,r,i,s){return dt(e,n.from(t),r,i,s)};var It=function(e){return e},qt=function(e){throw e};mt=function(e,t){return pt(e,t,It,qt)},gt=function(e,t,n){return mt(e,new b(t,w.initial,n))},yt=function(e,t,r){return gt(e,n.from(t),r)};var Rt=Nt(!0),Ut=Nt(!1);bt=function(e,t){return pt(e,t,Rt,Ut)},wt=function(e,t,n){return bt(e,new b(t,w.initial,n))},Et=function(e,t,r){return wt(e,n.from(t),r)},t.Tail=c,t.trampoline=h,t.ParserError=p,t.ParseError=d,t.MultipleError=v,t.UnknownError=m,t.UnexpectError=g,t.ExpectError=y,t.ParserState=b,t.Position=w,t.rec=E,t.Parser=S,t.RecParser=x,t.always=T,t.never=N,t.bind=C,t.eof=k,t.extract=L,t.getParserState=A,t.setParserState=O,t.modifyParserState=M,t.getState=_,t.setState=D,t.modifyState=P,t.getInput=H,t.setInput=B,t.getPosition=j,t.setPosition=F,t.fail=I,t.attempt=q,t.look=R,t.lookahead=U,t.next=z,t.sequences=W,t.sequencea=X,t.sequence=V,t.either=$,t.choices=J,t.choicea=K,t.choice=Q,t.optional=G,t.expected=Y,t.eager=Z,t.binds=et,t.cons=tt,t.append=nt,t.enumerations=rt,t.enumerationa=it,t.enumeration=st,t.many=ot,t.many1=ut,t.token=at,t.anyToken=ft,t.memo=lt,t.Memoer=ct,t.exec=ht,t.parseState=pt,t.parseStream=dt,t.parse=vt,t.runState=mt,t.runStream=gt,t.run=yt,t.testState=bt,t.testStream=wt,t.test=Et}),define("nu-stream/gen",["require","exports","./stream"],function(e,t,n){var r=n.NIL,i=n.memoStream,s,o;s=function(e,t){return e<=0?r:i(t,s.bind(null,e-1,t))};var u=function(e,t,n){return(n>0?t<=e:t>=e)?r:i(e,u.bind(null,e+n,t,n))};o=function(e,t,n){var r=isNaN(e)?Infinity:+e,i=isNaN(n)?1:+n;return isNaN(t)?u(0,r,i):u(r,t,i)},t.repeat=s,t.range=o}),define("bennu/lang",["require","exports","nu-stream/stream","nu-stream/gen","./parse"],function(e,t,n,r,i){var s=n.NIL,o=r.repeat,u=i.append,a=i.always,f=i.bind,l=i.cons,c=i.either,h=i.enumerations,p=i.many,d=i.many1,v=i.next,m=i.optional,g=i.ParserError,y=i.rec,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P=a(s),H=m.bind(null,s);b=function(e,t){return function(){return e(t.apply(null,arguments))}}(h,o),w=function(e,t){return e<=0?P:H(f(t,function(n){return l(a(n),w(e-1,t))}))},E=function(e,t,n){if(t<e)throw new g("between max < min");return u(b(e,n),w(t-e,n))},S=function(e,t){return f(e,function(e){return v(t,a(e))})},x=function(e,t,n){return v(e,S(n,t))},T=function(e,t){return l(t,p(v(e,t)))},N=function(e,t){return function(){return e(t.apply(null,arguments))}}(m.bind(null,s),T),C=function(e,t){return y(function(n){return l(t,H(v(e,H(n))))})},k=function(e,t){return c(C(e,t),v(m(null,e),a(s)))},L=function(e,t){return d(S(t,e))},A=function(e,t){return p(S(t,e))},O=function(e,t){return f(t,y(function(n){return function(r){return m(r,f(e,function(e){return f(t,function(t){return n(e(r,t))})}))}}))},M=function(e,t,n){return m(t,O(e,n))},_=function(e,t){return y(function(n){return f(t,function(t){return m(t,f(e,function(e){return f(n,function(n){return a(e(t,n))})}))})})},D=function(e,t,n){return m(t,_(e,n))},t.times=b,t.atMostTimes=w,t.betweenTimes=E,t.then=S,t.between=x,t.sepBy1=T,t.sepBy=N,t.sepEndBy1=C,t.sepEndBy=k,t.endBy1=L,t.endBy=A,t.chainl1=O,t.chainl=M,t.chainr1=_,t.chainr=D}),define("khepri-ast/serialization",["require","exports","./node"],function(e,t,n){var r,i,s,o=Object.keys,u=Function.prototype.call.bind(Array.prototype.map),a=Function.prototype.call.bind(Array.prototype.reduce),f=function(e){return e},l={};r=function(e,t){l[e]=t};var c=function(e,t,r){return e?Array.isArray(e)?u(e,function(e){return c(e,t,r)}):e instanceof n.Node?{type:e.type,loc:t(e.loc),ud:r(e.ud),children:a(e.children,function(n,i){return n[i]=c(e[i],t,r),n},{}),attributes:a(e.attributes,function(t,n){return t[n]=e[n],t},{})}:e:e};i=function(e,t,n){var r=c(e,t||f,n||f);return{version:"2.1.0",kind:"ecma",program:r}};var h=function(e,t,r){if(!e)return e;if(Array.isArray(e))return u(e,function(e){return h(e,t,r)});var i=l[e.type];if(!i)return e;var s=t(e.loc),f=r(e.ud),c=a(o(e.children),function(n,i){return n[i]=h(e.children[i],t,r),n},{}),p=a(o(e.attributes),function(t,n){return t[n]=e.attributes[n],t},{});return n.construct(i.prototype,s,f,c,p)};s=function(e,t,n){return h(e.program,t||f,n||f)},t.registerNode=r,t.serialize=i,t.unserialize=s}),define("khepri-ast/node",["require","exports","./serialization"],function(e,t,n){var r=n.registerNode,i,s,o,u,a,f,l,c,h,p,d=function(){var e=function(e){return e};return function(t,n){return t.concat([].map.call(n,e))}}(),v=Object.keys,m=Function.prototype.call.bind(Array.prototype.map),g=Function.prototype.call.bind(Array.prototype.reduce),y=function(e){var t=Object.create(Object.getPrototypeOf(e));return Object.getOwnPropertyNames(e).forEach(function(n){var r=this;t[n]=e[n]}),t},b=function(e,t,n){return Object.defineProperty(y(e),t,n)};i=function(e,t){var n=this;Object.defineProperties(n,{loc:{value:e,enumerable:!1},ud:{value:t||null,enumerable:!1}})},s=function(e,t,n,r,i){var s={};return Object.keys(r).forEach(function(e){s[e]={value:r[e],enumerable:!0,configurable:!0}}),e.children.forEach(function(e){s[e]=s[e]||{value:null,enumerable:!0,configurable:!0}}),Object.keys(i).forEach(function(e){var t=this;s[e]={value:i[e],enumerable:!0,configurable:!0}}),s.loc={value:t,enumerable:!1},s.ud={value:n,enumerable:!1},Object.create(e,s)},o=function(e,t,n){return s(Object.getPrototypeOf(e),e.loc,e.ud,t,n)},u=function(e,t,n){var r={},i={};return e.children.forEach(function(t){r[t]=e[t]}),t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),e.attributes.forEach(function(t){i[t]=e[t]}),n&&Object.keys(n).forEach(function(e){i[e]=n[e]}),o(e,r,i)},a=function(e,t){return s(Object.getPrototypeOf(e),t,e.ud,g(e.children,function(t,n){return t[n]=e[n],t},{}),g(e.attributes,function(t,n){return t[n]=e[n],t},{}))},f=function(e,t){return s(Object.getPrototypeOf(e),e.loc,t,g(e.children,function(t,n){return t[n]=e[n],t},{}),g(e.attributes,function(t,n){return t[n]=e[n],t},{}))},l=function(e,t){return e.ud?e.ud[t]:null},c=function(e,t,n){return f(e,b(e.ud||{},t,{value:n(l(e,t)),enumerable:!0}))},h=function(e,t,n){return c(e,t,function(){return n})},p=function(e,t,n,i,s){return s.type=t,s.prototype=new e,s.prototype.constructor=s,s.prototype.children=n,s.prototype.attributes=i,s.prototype.type=s.type,s.create=function(){var e=arguments;return new(s.bind.apply(s,d([null],e)))},r(t,s),s},t.Node=i,t.construct=s,t.reconstruct=o,t.modify=u,t.setLoc=a,t.setUserData=f,t.getData=l,t.modifyData=c,t.setData=h,t.defineNode=p}),define("khepri-ast/token",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u,a,f,l,c,h,p,d,v,m;s=function(e,t){var n=this;i.call(n,e),n.value=t},s.prototype=new i,o=r(s,"String",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),u=r(s,"Number",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),a=r(s,"RegularExpression",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),f=r(s,"Boolean",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),l=r(s,"Null",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),c=r(s,"Identifier",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),h=r(s,"Keyword",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),p=r(s,"Punctuator",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),d=r(s,"Comment",[],["value","multiline","linebreak"],function(e,t,n,r){var i=this;s.call(i,e,t),i.multiline=!!n,i.linebreak=!!r}),v=r(s,"Whitespace",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),m=r(s,"LineTerminator",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),t.Token=s,t.StringToken=o,t.NumberToken=u,t.RegularExpressionToken=a,t.BooleanToken=f,t.NullToken=l,t.IdentifierToken=c,t.KeywordToken=h,t.PunctuatorToken=p,t.CommentToken=d,t.WhitespaceToken=v,t.LineTerminatorToken=m}),define("khepri/position",["require","exports","bennu/parse"],function(e,t,n){var r,i;r=function(e,t){var n=this;n.line=e,n.column=t},r.prototype=new n.Position,r.prototype.constructor=r,r.initial=new r(1,0),r.prototype.increment=function(e){var t=this;return e==="\n"?new r(t.line+1,0):new r(t.line,t.column+1)},r.prototype.toString=function(){var e=this;return"{line:"+e.line+" col:"+e.column+"}"},r.prototype.compare=function(e){var t=this;return t.line===e.line?t.column-e.column:t.line-e.line},i=function(e,t){var n=this;n.start=e,n.end=t},i.prototype.toString=function(){var e=this;return"{start:"+e.start+" end:"+e.end+"}"},i.merge=function(e,t){return new i(e.start.compare(t.start)>0?t.start:e.start,e.end.compare(t.end)>0?e.end:t.end)},t.SourcePosition=r,t.SourceLocation=i}),define("bennu/text",["require","exports","./parse"],function(e,t,n){var r=n.always,i=n.attempt,s=n.bind,o=n.either,u=n.ExpectError,a=n.next,f=n.Parser,l=n.token,c,h,p,d,v,m,g,y,b,w=Function.prototype.call.bind(Array.prototype.join),E=Function.prototype.call.bind(Array.prototype.map),S=Function.prototype.call.bind(Array.prototype.reduce),x=Function.prototype.call.bind(Array.prototype.reduceRight),T=function(e){return function(t,n){return new u(t,e,n===null?"end of input":n)}},N=function(e,t,n,r,i){var s=this;u.call(s,e,r,i),s.string=t,s.index=n};N.prototype=new u,N.prototype.constructor=N,Object.defineProperty(N.prototype,"errorMessage",{get:function(){var e=this;return"In string:'"+e.string+"' at index:"+e.index+", Expected:"+e.expected+" Found:"+(e.found?e.found:"end of input")}});var C=function(){var e=function(e){var t=e.valueOf();return function(e){return t===e.valueOf()}};return function(t,n){return l(e(t),n)}}.call(this);c=function(e){return C(e,T(e))},h=function(e){var t=E(e,function(e){return e.valueOf()}),n=function(e){return t.indexOf(e.valueOf())!==-1};return l(n,T(w(e," or ")))};var k=function(e,t,n,r){return a(C(t,function(e,i){return new N(e,r,n,t,i)}),e)};p=function(e){return i(x(e,k,r(e+"")))};var L=function(e,t){return e[t]=e[t]||{},e[t]},A=function(e,t){var n=S(t,L,e);return n[""]=t,e},O=function(e){return S(e,A,{})},M=function(e){var t=Object.keys(e),n=S(t,function(t,n){return n.length&&(t[n]=M(e[n])),t},{}),u=i(s(h(t),function(e){return n[e]}));return e.hasOwnProperty("")?o(u,r(e[""])):u};d=function(e){return i(M(O(e),""))},v=function(e,t){return l(RegExp.prototype.test.bind(e),T(t))},m=f("Any Character",v(/^.$/,"any character")),g=f("Any Letter",v(/^[a-z]$/i,"any letter character")),y=f("Any Whitespace",v(/^\s$/i,"any space character")),b=f("Any Digit",v(/^[0-9]$/i,"any digit character")),t.character=c,t.characters=h,t.string=p,t.trie=d,t.match=v,t.anyChar=m,t.letter=g,t.space=y,t.digit=b}),define("khepri/lex/boolean_lexer",["require","exports","bennu/parse","bennu/text"],function(e,t,n,r){var i=n.always,s=n.either,o=n.next,u=n.Parser,a=r.string,f,l,c;f=u("True Literal Lexer",o(a("true"),i(!0))),l=u("False Literal Lexer",o(a("false"),i(!1))),c=u("Boolean Literal Lexer",s(f,l)),t.trueLiteral=f,t.falseLiteral=l,t.booleanLiteral=c}),define("khepri/lex/line_terminator_lexer",["require","exports","bennu/parse","bennu/text"],function(e,t,n,r){var i=n.always,s=n.choice,o=n.next,u=n.optional,a=n.Parser,f=n.token,l=r.character,c=r.characters,h,p,d,v,m,g,y="\n",b="\r",w="\u2028",E="\u2029";h=a("Line Feed Lexer",l(y)),p=a("Carriage Return Lexer",l(b)),d=a("Line Separator Lexer",l(w)),v=a("Paragraph Separator Lexer",l(E)),m=a("Line Terminator Lexer",c([y,b,w,E])),g=a("Line Terminator Sequence Lexer",s(h,d,v,o(p,u(b,o(h,i(b+y)))))),t.lf=h,t.cr=p,t.ls=d,t.ps=v,t.lineTerminator=m,t.lineTerminatorSequence=g}),define("khepri/lex/comment_lexer",["require","exports","bennu/parse","bennu/text","nu-stream/stream","./line_terminator_lexer"],function(e,t,n,r,i,s){var o=n.anyToken,u=n.always,a=n.bind,f=n.cons,l=n.either,c=n.many,h=n.next,p=n.Parser,d=n.RecParser,v=n.test,m=n.token,g=r.character,y=r.string,b=i.foldl,w=i.NIL,E=s.lineTerminator,S,x,T,N,C,k,L,A,O,M=function(e){return a(e,function(e,t){return function(n){return e(t(n))}}(u,b.bind(null,function(e,t){return e+t},"")))};S=y("//"),x=m(function(e,t){return function(n){return e(t(n))}}(function(e){return!e},v.bind(null,E))),T=c(x),N=p("Single Line Comment Lexer",h(S,M(T))),C=y("/*"),k=y("*/"),L=d("Multi Line Comment Characters Lexer",function(e){return l(h(g("*"),l(h(g("/"),u(w)),f(u("*"),e))),f(o,e))}),A=p("Multi Line Comment Lexer",h(C,M(L))),O=p("Comment Lexer",l(N,A)),t.singleLineCommentMarker=S,t.singleLineCommentChar=x,t.singleLineCommentChars=T,t.singleLineComment=N,t.multiLineCommentStartMarker=C,t.multiLineCommentEndMarker=k,t.multiLineCommentChars=L,t.multiLineComment=A,t.comment=O}),define("khepri/lex/null_lexer",["require","exports","bennu/parse","bennu/text"],function(e,t,n,r){var i=n.always,s=n.next,o=n.Parser,u=r.string,a;a=o("Null Lexer",s(u("null"),i(null))),t.nullLiteral=a}),define("khepri/lex/reserved_word_lexer",["require","exports","bennu/parse","bennu/text","./boolean_lexer","./null_lexer"],function(e,t,n,r,i,s){var o=n.attempt,u=n.choice,a=n.Parser,f=r.string,l=r.trie,c=i.booleanLiteral,h=s.nullLiteral,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et,tt,nt,rt,it,st,ot=["break","case","catch","continue","debugger","default","delete","do","else","finally","for","function","if","in","instanceof","typeof","new","var","return","void","switch","while","this","with","throw","try","export","package","class","enum","interface","extends","implements","private","public","protected","super","const","yield","import","let","static","_"];v=f("break"),m=f("case"),g=f("catch"),y=f("continue"),b=f("debugger"),w=f("default"),E=f("delete"),S=f("do"),x=f("else"),T=f("finally"),N=f("for"),C=f("function"),k=f("if"),L=f("in"),A=f("instanceof"),O=f("typeof"),M=f("new"),_=f(""),D=f("return"),P=f("void"),H=f("switch"),B=f("while"),j=f("this"),F=f("with"),I=f("throw"),q=f("try"),U=f("get"),z=f("set"),R=u(o(v),o(m),o(g),o(y),o(b),o(w),o(E),o(S),o(x),o(T),o(N),o(C),o(k),o(L),o(A),o(O),o(M),o(_),o(D),o(P),o(H),o(B),o(j),o(F),o(I),o(q)),W=f("class"),X=f("enum"),V=f("extends"),$=f("super"),J=f("const"),K=f("export"),Q=f("import"),G=f("implements"),Y=f("let"),Z=f("private"),et=f("public"),tt=f("interface"),nt=f("package"),rt=f("protected"),it=f("static"),st=f("yield"),d=u(o(W),o(X),o(V),o($),o(J),o(K),o(Q),o(G),o(Y),o(Z),o(et),o(tt),o(nt),o(rt),o(it),st),p=a("ReservedWordLexer",u(l(ot),h,c)),t.reservedWord=p,t.futureReservedWord=d,t.breakKeyword=v,t.caseKeyword=m,t.catchKeyword=g,t.continueKeyword=y,t.debuggerKeyword=b,t.defaultKeyword=w,t.deleteKeyword=E,t.doKeyword=S,t.elseKeyword=x,t.finallyKeyword=T,t.forKeyword=N,t.functionKeyword=C,t.ifKeyword=k,t.inKeyword=L,t.instanceofKeyword=A,t.typeofKeyword=O,t.newKeyword=M,t.Keyword=_,t.returnKeyword=D,t.voidKeyword=P,t.switchKeyword=H,t.whileKeyword=B,t.thisKeyword=j,t.withKeyword=F,t.throwKeyword=I,t.tryKeyword=q,t.keyword=R,t.getKeyword=U,t.setKeyword=z,t.classKeyword=W,t.enumKeyword=X,t.extendsKeyword=V,t.superKeyword=$,t.constKeyword=J,t.exportKeyword=K,t.importKeyword=Q,t.implementsKeyword=G,t.letKeyword=Y,t.privateKeyword=Z,t.publicKeyword=et,t.interfaceKeyword=tt,t.packageKeyword=nt,t.protectedKeyword=rt,t.staticKeyword=it,t.yieldKeyword=st}),define("khepri/lex/number_lexer",["require","exports","bennu/parse","bennu/lang","bennu/text","nu-stream/stream"],function(e,t,n,r,i,s){var o=n.always,u=n.attempt,a=n.bind,f=n.binds,l=n.choice,c=n.either,h=n.enumeration,p=n.expected,d=n.many,v=n.many1,m=n.next,g=n.optional,y=n.Parser,b=r.then,w=i.character,E=i.characters,S=i.match,x=i.string,T=s.foldl,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U=function(e){return a(e,function(e,t){return function(n){return e(t(n))}}(o,T.bind(null,function(e,t){return e+t},"")))};N=y("Decimal Lexer",w(".")),C=y("Negative Sign Lexer",w("-")),k=y("Positive Sign Lexer",w("+")),L=y("Exponent Indicator Lexer",E("eE")),A=y("Hex Indicator Lexer",c(x("0x"),x("0X"))),O=y("Decimal Digit Lexer",E("0123456789")),M=y("Non Zero Digit Lexer",E("123456789")),_=y("Hex Digit Lexer",E("0123456789abcdefABCDEF")),D=y("Decimal Digits Lexer",U(v(O))),P=y("Hex Digits Lexer",U(v(_))),H=y("Unsigned Integer Lexer",a(D,function(e,t){return function(n){return e(t(n))}}(o,parseInt))),B=y("Signed Integer Lexer",c(m(C,a(H,function(e,t){return function(n){return e(t(n))}}(o,function(e){return-e}))),m(g(null,k),H)));var z=y("Hex Integer Literal Digits Lexer",a(P,function(e){return o(parseInt(e,16))}));j=y("Exponent Part Lexer",m(L,B)),F=y("Hex Integer Literal Lexer",m(A,z)),I=y("Decimal Integer Literal",a(D,function(e,t){return function(n){return e(t(n))}}(o,parseInt))),q=y("Decimal Literal Lexer",f(h(f(h(D,g(0,u(m(N,D)))),function(e,t){return o(parseFloat(e+"."+t))}),g(0,j)),function(e,t){return o(e*Math.pow(10,parseInt(t)))})),R=y("Numeric Literal Lexer",c(m(u(A),p("hex digits",z)),q)),t.decimal=N,t.negativeSign=C,t.positiveSign=k,t.exponentIndicator=L,t.hexIndicator=A,t.decimalDigit=O,t.nonZeroDigit=M,t.hexDigit=_,t.decimalDigits=D,t.hexDigits=P,t.unsignedInteger=H,t.signedInteger=B,t.exponentPart=j,t.hexIntegerLiteral=F,t.decimalIntegerLiteral=I,t.decimalLiteral=q,t.numericLiteral=R}),define("khepri/lex/string_lexer",["require","exports","bennu/parse","bennu/text","bennu/lang","nu-stream/stream","./line_terminator_lexer","./number_lexer"],function(e,t,n,r,i,s,o,u){var a=n.always,f=n.attempt,l=n.bind,c=n.choice,h=n.either,p=n.eof,d=n.many,v=n.next,m=n.sequence,g=n.Parser,y=n.test,b=n.token,w=r.character,E=i.between,S=i.times,x=s.foldl,T=o.lineTerminatorSequence,N=o.lineTerminator,C=u.decimalDigit,k=u.hexDigit,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z=x.bind(null,function(e,t){return e+t},""),W=function(e,t){return function(n){return e(t(n))}}(a,function(e,t){return function(n){return e(t(n))}}(String.fromCharCode,function(e,t){return function(n){return e(t(n))}}(function(e){return parseInt(e,16)},z)));L=g("Double Quote Lexer",w('"')),O=g("Single Quote Lexer",w("'")),A=g("String Escape Lexer",w("\\")),M=g("String Line Continuation Lexer",m(A,T,a("")));var X=c(w("'"),w('"'),w("\\"),v(w("b"),a("\b")),v(w("f"),a("\f")),v(w("n"),a("\n")),v(w("r"),a("\r")),v(w("t"),a("	")),v(w("v"),a(""))),V=c(X,C,w("u"),w("x")),$=b(function(e){return!y(V,e)&&!y(N,e)});D=v(w("x"),l(S(2,k),W)),_=v(w("u"),l(S(4,k),W)),P=h(X,$),H=c(P,m(w("0"),h(p,b(function(e,t){return function(n){return e(t(n))}}(function(e){return!e},y.bind(null,C)))),a("\0")),D,_),B=c(f(M),v(A,H),b(function(e){return!(y(O,e)||y(A,e)||y(N,e))})),j=d(B),F=g("Single String Literal",E(O,O,l(j,function(e,t){return function(n){return e(t(n))}}(a,z)))),I=c(f(M),v(A,H),b(function(e){return!(y(L,e)||y(A,e)||y(N,e))})),q=d(I),R=g("Double String Literal",E(L,L,l(q,function(e,t){return function(n){return e(t(n))}}(a,z)))),U=g("Sting Literal Lexer",h(F,R)),t.doubleQuote=L,t.escape=A,t.singleQuote=O,t.lineContinuation=M,t.unicodeEscapeSequence=_,t.hexEscapeSequence=D,t.characterEscapeSequence=P,t.escapeSequence=H,t.singleStringCharacter=B,t.singleStringCharacters=j,t.singleStringLiteral=F,t.doubleStringCharacter=I,t.doubleStringCharacters=q,t.doubleStringLiteral=R,t.stringLiteral=U}),define("khepri/lex/identifier_lexer",["require","exports","bennu/parse","bennu/text","nu-stream/stream","./reserved_word_lexer","./string_lexer"],function(e,t,n,r,i,s,o){var u=n.always,a=n.attempt,f=n.bind,l=n.cons,c=n.choice,h=n.either,p=n.eof,d=n.fail,v=n.many,m=n.never,g=n.next,y=n.Parser,b=n.testStream,w=n.token,E=r.character,S=r.characters,x=r.digit,T=r.letter,N=r.string,C=i.foldl,k=s.reservedWord,L=o.escape,A=o.unicodeEscapeSequence,O,M,_,D,P,H,B,j,F,I,q,R=C.bind(null,function(e,t){return e+t},"");O=E("‌"),M=E("‍"),_=T,D=x,P=S(["_","‿","⁀","⁔","︳","︴","﹍","﹎","﹏","＿"]),H=m(),B=c(_,S("$_"),g(L,A)),j=c(a(B),H,D,P,O,M),F=v(j),I=l(B,F);var U=g(k,p);q=y("Identifier Lexer",f(I,function(e){return b(U,e)?d():u(R(e))})),t.zwnj=O,t.zwj=M,t.unicodeLetter=_,t.unicodeDigit=D,t.unicodeConnectorPunctuation=P,t.unicodeCombiningMark=H,t.identifierStart=B,t.identifierPart=j,t.identifierParts=F,t.identifierName=I,t.identifier=q}),define("khepri/lex/punctuator_lexer",["require","exports","bennu/parse","bennu/text"],function(e,t,n,r){var i=n.Parser,s=r.character,o=r.string,u=r.trie,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,et=["{","}","(",")","[","]",",",".",";",":","?","&&","||","<<",">>",">>>","<=","<",">=",">","===","!==","==","!=","=","!","~","++","--","&","|","^","+","-","*","/","%","@","\\>","\\>>","<\\","<<\\","|>","<|","...","#","\\","->"];a=s("{"),f=s("}"),l=s("("),c=s(""),h=s("["),p=s("]"),d=s("."),v=s(";"),m=s(","),g=s(":"),y=s("?"),b=o("&&"),w=o("||"),E=o("<<"),S=o(">>"),x=o(">>>"),T=o("<="),N=s("<"),C=o(">="),k=s(">"),L=o("==="),A=o("!=="),O=o("=="),M=o("!="),H=s("="),B=s("!"),j=s("~"),_=s("&"),D=s("|"),P=s("^"),F=s("+"),I=s("-"),q=s("*"),U=s("/"),R=s("%"),Q=s("#"),K=o("..."),G=s("\\"),Y=o("->"),Z=i("Punctuator Lexer",u(et)),t.openBrace=a,t.closeBrace=f,t.openParenthesis=l,t.closeParenthesis=c,t.openBracket=h,t.closeBracket=p,t.period=d,t.semicolon=v,t.comma=m,t.colon=g,t.questionMark=y,t.logicalAnd=b,t.logicalOr=w,t.leftShift=E,t.signedRightShift=S,t.unsignedRightShift=x,t.lessThanOrEqualTo=T,t.lessThan=N,t.greaterThanOrEqualTo=C,t.greaterThan=k,t.strictEquals=L,t.strictDoesNotEqual=A,t.equals=O,t.doesNotEqual=M,t.and=_,t.or=D,t.xor=P,t.assign=H,t.logicalNot=B,t.bitwiseNot=j,t.addition=F,t.subtration=I,t.multiplication=q,t.mod=R,t.division=U,t.compose=z,t.composeNary=W,t.reverseCompose=X,t.reverseComposeNary=V,t.pipe=$,t.reversePipe=J,t.ellipsis=K,t.as=Q,t.argumentList=G,t.lambda=Y,t.punctuator=Z}),define("khepri/lex/whitespace_lexer",["require","exports","bennu/parse","bennu/text","nu-stream/stream"],function(e,t,n,r,i){var s=n.always,o=n.bind,u=n.many1,a=n.Parser,f=r.character,l=r.characters,c=r.match,h=i.foldl,p,d,v,m,g,y,b,w,E=function(e){return o(e,function(e,t){return function(n){return e(t(n))}}(s,h.bind(null,function(e,t){return e+t},"")))},S="	",x="",T="\f",N=" ",C=" ",k="﻿";p=f(S),d=f(x),v=f(T),m=f(N),g=f(C),y=f(k),b=c(/^\s$/),w=a("Whitespace Character Lexer",l([S,x,T,N,C,k])),t.tab=p,t.vt=d,t.ff=v,t.sp=m,t.nbsp=g,t.bom=y,t.usp=b,t.whitespace=w}),define("khepri/lex/regular_expression_lexer",["require","exports","bennu/parse","bennu/lang","bennu/text","nu-stream/stream","./identifier_lexer","./line_terminator_lexer"],function(e,t,n,r,i,s,o,u){var a=n.always,f=n.attempt,l=n.bind,c=n.binds,h=n.choice,p=n.cons,d=n.either,v=n.enumeration,m=n.many,g=n.next,y=n.Parser,b=n.token,w=n.test,E=r.between,S=i.character,x=s.foldl,T=o.identifierPart,N=u.lineTerminator,C,k,L,A,O,M,_,D,P,H,B,j=x.bind(null,function(e,t){return e+t},"");C=b(function(e,t){return function(n){return e(t(n))}}(function(e){return!e},w.bind(null,N))),k=g(S("\\"),l(C,function(e,t){return function(n){return e(t(n))}}(a,function(e,t){return e+t}.bind(null,"\\")))),L=d(f(b(function(e){return!w(N,e)&&e!=="]"&&e!=="\\"})),k),A=m(L),O=E(S("["),S("]"),l(A,function(e){return a("["+j(e)+"]")})),D=h(b(function(e){return!w(N,e)&&e!=="*"&&e!=="\\"&&e!=="`"&&e!=="["}),k,O),M=h(b(function(e){return!w(N,e)&&e!=="\\"&&e!=="`"&&e!=="["}),k,O),_=m(M),P=m(T),H=l(p(D,_),function(e,t){return function(n){return e(t(n))}}(a,j)),B=y("Regular Expression Lexer",c(v(E(S("`"),S("`"),H),P),function(e,t){return a(new RegExp(e,j(t)))})),t.regularExpressionNonTerminator=C,t.regularExpressionBackslashSequence=k,t.regularExpressionClassChar=L,t.regularExpressionClassChars=A,t.regularExpressionClass=O,t.regularExpressionChar=M,t.regularExpressionChars=_,t.regularExpressionFirstChar=D,t.regularExpressionFlags=P,t.regularExpressionBody=H,t.regularExpressionLiteral=B}),define("khepri/lex/lexer",["require","exports","bennu/parse","bennu/lang","nu-stream/stream","khepri-ast/token","../position","./boolean_lexer","./comment_lexer","./identifier_lexer","./line_terminator_lexer","./null_lexer","./number_lexer","./punctuator_lexer","./reserved_word_lexer","./string_lexer","./whitespace_lexer","./regular_expression_lexer"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=n.always,b=n.attempt,w=n.binds,E=n.bind,S=n.choice,x=n.either,T=n.eof,N=n.getPosition,C=n.enumeration,k=n.extract,L=n.expected,A=n.next,O=n.many,M=n.runState,_=n.Parser,D=n.ParserState,P=r.then,H=i.memoStream,B=i.NIL,j=i.from,F=o.SourceLocation,I=o.SourcePosition,q=u.booleanLiteral,R=a.comment,U=f.identifier,z=f.identifierName,W=l.lineTerminator,X=c.nullLiteral,V=h.numericLiteral,$=p.punctuator,J=d.reservedWord,K=v.stringLiteral,Q=m.whitespace,G=g.regularExpressionLiteral,Y,Z,et,tt,nt,rt,it=function(e,t){return E(t,function(t){return y([e,t])})},st=function(e){return w(C(N,e,N),function(e,t,n){var r=t[0],i=t[1];return y(new r(new F(e,n),i))})},ot=S(L("string literal",it(s.StringToken,K)),L("regular expression literal",it(s.RegularExpressionToken,G)),L("boolean literal",it(s.BooleanToken,q)),L("null literal",it(s.NullToken,X)),L("number literal",it(s.NumberToken,V))),ut=S(L("identifier",b(it(s.IdentifierToken,U))),b(ot),L("reserved word",b(it(s.KeywordToken,J))),L("puctuator",it(s.PunctuatorToken,$))),at=S(L("comment",it(s.CommentToken,R)),L("whitespace",it(s.WhitespaceToken,Q)),L("line terminator",it(s.LineTerminatorToken,W)),ut);Y=st(ot),Z=st(ut),et=st(at),tt=P(O(et),T),rt=function(e){return M(tt,new D(j(e),I.initial))},t.literal=Y,t.token=Z,t.inputElement=et,t.lexer=tt,t.lexManyState=nt,t.lex=rt}),define("khepri-ast/program",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s;s=r(i,"Program",["body"],[],function(e,t){var n=this;i.call(n,e),n.body=t}),t.Program=s}),define("khepri/parse/common",["require","exports","bennu/parse","nu-stream/stream","../position"],function(e,t,n,r,i){var s=n.always,o=n.bind,u=n.binds,a=n.extract,f=n.enumeration,l=n.eager,c=n.optional,h=r.NIL,p=i.SourceLocation,d,v,m,g;d=function(e,t){var r=n.choicea(t.map(function(e){return o(e.sep,function(t){var n=t.value;return s({value:n,node:e.node,precedence:e.precedence,right:e.right},n)})}));return o(l(n.rec(function(t){return n.cons(e,c(h,n.cons(r,n.expected("binary expression",t))))})),function(e){var t=[],n=[];while(e.length>0){var r=e.shift();if(r.type)n.push(r);else{while(t.length>0){var i=t[t.length-1];if(!(!r.right&&i.precedence===r.precedence||i.precedence<r.precedence))break;t.pop();var o=n.pop(),u=n.pop();n.push(new i.node(p.merge(u.loc,o.loc),i.value,u,o))}t.push(r)}}while(t.length>0){var a=t.pop(),f=n.pop(),l=n.pop();n.push(new a.node(p.merge(l.loc,f.loc),a.value,l,f))}return s(n.pop())})},g=a(function(e){var t=e.position;return t});var y=a(function(e){var t=e.loc;return t}),b=a(function(e){var t=e._prevEnd;return t});v=function(e,t){return u(f(y,e,b),function(e,n,r){return s(t(new p(e&&e.start,r),n))})},m=function(e,t){return u(f(y,e,b),function(e,n,i){return s(t.apply(undefined,r.toArray(r.cons(new p(e&&e.start,i),n))))})},t.precedence=d,t.node=v,t.nodea=m,t.positionParser=g}),define("khepri-ast/clause",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u;s=function(){},s.prototype=new i,o=r(s,"SwitchCase",["test","consequent"],[],function(e,t,n){var r=this;i.call(r,e),r.test=t||null,r.consequent=n}),u=r(s,"CatchClause",["param","body"],[],function(e,t,n){var r=this;i.call(r,e),r.param=t,r.body=n}),t.Clause=s,t.SwitchCase=o,t.CatchClause=u}),define("khepri-ast/declaration",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u,a,f,l;s=function(){},s.prototype=new i,o=r(s,"VariableDeclaration",["declarations"],[],function(e,t){var n=this;i.call(n,e),n.declarations=t}),u=r(s,"VariableDeclarator",["id","init"],[],function(e,t,n){var r=this;i.call(r,e),r.id=t,r.init=n||null}),a=r(s,"Binding",["pattern","value"],[],function(e,t,n){var r=this;i.call(r,e),r.pattern=t,r.value=n}),f=r(s,"StaticDeclaration",["declarations"],[],function(e,t){var n=this;i.call(n,e),n.declarations=t}),l=r(s,"StaticDeclarator",["id","init"],[],function(e,t,n){var r=this;i.call(r,e),r.id=t,r.init=n}),t.Declaration=s,t.VariableDeclaration=o,t.VariableDeclarator=u,t.Binding=a,t.StaticDeclaration=f,t.StaticDeclarator=l}),define("khepri-ast/statement",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;s=function(){var e=this},s.prototype=new i,o=r(s,"EmptyStatement",[],[],function(e){var t=this;i.call(t,e)}),u=r(s,"DebuggerStatement",[],[],function(e){var t=this;i.call(t,e)}),f=r(s,"BlockStatement",["body"],[],function(e,t){var n=this;i.call(n,e),n.body=t}),l=r(s,"ExpressionStatement",["expression"],[],function(e,t){var n=this;i.call(n,e),n.expression=t}),c=r(s,"IfStatement",["test","consequent","alternate"],[],function(e,t,n,r){var s=this;i.call(s,e),s.test=t,s.consequent=n,s.alternate=r||null}),a=r(s,"WithStatement",["bindings","body"],[],function(e,t,n){var r=this;i.call(r,e),r.bindings=t,r.body=n}),h=r(s,"BreakStatement",[],[],function(e){var t=this;i.call(t,e)}),p=r(s,"ContinueStatement",[],[],function(e){var t=this;i.call(t,e)}),d=r(s,"SwitchStatement",["discriminant","cases"],[],function(e,t,n){var r=this;i.call(r,e),r.discriminant=t,r.cases=n}),v=r(s,"ReturnStatement",["argument"],[],function(e,t){var n=this;i.call(n,e),n.argument=t||null}),m=r(s,"ThrowStatement",["argument"],[],function(e,t){var n=this;i.call(n,e),n.argument=t}),g=r(s,"TryStatement",["block","handler","finalizer"],[],function(e,t,n,r){var s=this;i.call(s,e),s.block=t,s.handler=n,s.finalizer=r}),y=r(s,"WhileStatement",["test","body"],[],function(e,t,n){var r=this;i.call(r,e),r.test=t,r.body=n}),b=r(s,"DoWhileStatement",["body","test"],[],function(e,t,n){var r=this;i.call(r,e),r.test=n,r.body=t}),w=r(s,"ForStatement",["init","test","update","body"],[],function(e,t,n,r,s){var o=this;i.call(o,e),o.init=t||null,o.test=n||null,o.update=r||null,o.body=s}),t.Statement=s,t.EmptyStatement=o,t.DebuggerStatement=u,t.WithStatement=a,t.BlockStatement=f,t.ExpressionStatement=l,t.IfStatement=c,t.BreakStatement=h,t.ContinueStatement=p,t.SwitchStatement=d,t.ReturnStatement=v,t.ThrowStatement=m,t.TryStatement=g,t.WhileStatement=y,t.DoWhileStatement=b,t.ForStatement=w}),define("khepri/parse/token_parser",["require","exports","bennu/parse"],function(e,t,n){var r,i,s,o,u,a,f,l,c,h=Function.prototype.call.bind(Array.prototype.indexOf),p=Function.prototype.call.bind(Array.prototype.join),d=function(e){return function(t,r){return new n.ExpectError(t,e,r===null?"end of input":r.value)}},v=function(e,t){return n.token(function(t){return t.type===e},d(t))},m=function(e){return function(){var t=arguments;return n.token(function(n){return n.type===e&&h(t,n.value)>=0},d(p(t,", ")))}};r=m("Punctuator"),i=m("Keyword"),o=v("Identifier","any identifier"),s=m("Identifier"),u=v("Null","Null literal"),a=v("Boolean","boolean literal"),f=v("Number","numeric literal"),l=v("String","string literal"),c=v("RegularExpression","regular expression literal"),t.punctuator=r,t.keyword=i,t.identifier=s,t.anyIdentifier=o,t.nullLiteral=u,t.booleanLiteral=a,t.numericLiteral=f,t.stringLiteral=l,t.regularExpressionLiteral=c}),define("khepri-ast/expression",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;s=function(){var e=this},s.prototype=new i,o=r(s,"ThisExpression",[],[],function(e){var t=this;i.call(t,e)}),u=r(s,"UnaryExpression",["argument"],["operator"],function(e,t,n){var r=this;i.call(r,e),r.operator=t,r.argument=n}),a=r(s,"BinaryExpression",["left","right"],["operator"],function(e,t,n,r){var s=this;i.call(s,e),s.operator=t,s.left=n,s.right=r}),f=r(s,"AssignmentExpression",["left","right"],["operator"],function(e,t,n,r){var s=this;i.call(s,e),s.operator=t,s.left=n,s.right=r}),l=r(s,"LogicalExpression",["left","right"],["operator"],function(e,t,n,r){var s=this;i.call(s,e),s.operator=t,s.left=n,s.right=r}),c=r(s,"ConditionalExpression",["test","consequent","alternate"],[],function(e,t,n,r){var s=this;i.call(s,e),s.test=t,s.consequent=n,s.alternate=r}),h=r(s,"NewExpression",["callee","args"],[],function(e,t,n){var r=this;i.call(r,e),r.callee=t,r.args=n}),p=r(s,"CallExpression",["callee","args"],[],function(e,t,n){var r=this;i.call(r,e),r.callee=t,r.args=n}),d=r(s,"MemberExpression",["object","property"],["computed"],function(e,t,n,r){var s=this;i.call(s,e),s.object=t,s.property=n,s.computed=r}),v=r(s,"FunctionExpression",["id","params","body"],[],function(e,t,n,r){var s=this;i.call(s,e),s.id=t||null,s.params=n,s.body=r}),m=r(s,"ArrayExpression",["elements"],[],function(e,t){var n=this;i.call(n,e),n.elements=t}),g=r(s,"ObjectExpression",["properties"],[],function(e,t){var n=this;i.call(n,e),n.properties=t}),y=r(s,"LetExpression",["bindings","body"],[],function(e,t,n){var r=this;i.call(r,e),r.bindings=t,r.body=n}),b=r(s,"CurryExpression",["base","args"],[],function(e,t,n){var r=this;i.call(r,e),r.base=t,r.args=n}),w=r(s,"UnaryOperatorExpression",[],["op"],function(e,t){var n=this;i.call(n,e),n.op=t}),E=r(s,"BinaryOperatorExpression",[],["op"],function(e,t){var n=this;i.call(n,e),n.op=t}),S=r(s,"TernaryOperatorExpression",[],["op"],function(e,t){var n=this;i.call(n,e),n.op=t}),t.Expression=s,t.ThisExpression=o,t.UnaryExpression=u,t.BinaryExpression=a,t.AssignmentExpression=f,t.LogicalExpression=l,t.ConditionalExpression=c,t.NewExpression=h,t.CallExpression=p,t.MemberExpression=d,t.FunctionExpression=v,t.ArrayExpression=m,t.ObjectExpression=g,t.LetExpression=y,t.CurryExpression=b,t.UnaryOperatorExpression=w,t.BinaryOperatorExpression=E,t.TernaryOperatorExpression=S}),define("khepri-ast/pattern",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u,a,f,l,c,h,p,d,v;s=function(e){var t=this;i.call(t,e)},s.prototype=new i,o=r(s,"IdentifierPattern",["id"],[],function(e,t){var n=this;s.call(n,e),n.id=t}),u=r(s,"EllipsisPattern",[],["id"],function(e,t){var n=this;s.call(n,e),n.id=t||null}),a=r(s,"SinkPattern",[],[],function(e){var t=this;s.call(t,e)}),f=r(i,"ImportPattern",["from","pattern"],[],function(e,t,n){var r=this;i.call(r,e),r.from=t,r.pattern=n}),l=r(s,"ArrayPattern",["elements"],[],function(e,t){var n=this;s.call(n,e),n.elements=t}),c=r(s,"ObjectPatternElement",["key","target"],[],function(e,t,n){var r=this;s.call(r,e),r.key=t,r.target=n||null}),h=r(s,"ObjectPattern",["elements"],[],function(e,t){var n=this;s.call(n,e),n.elements=t}),v=r(s,"AsPattern",["id","target"],[],function(e,t,n){var r=this;s.call(r,e),r.id=t,r.target=n}),d=r(s,"SubPattern",["id","elements"],[],function(e,t,n){var r=this;s.call(r,e),r.id=t,r.elements=n}),p=r(s,"ArgumentsPattern",["id","elements","self"],[],function(e,t,n,r){var i=this;s.call(i,e),i.id=t,i.elements=n,i.self=r}),t.Pattern=s,t.IdentifierPattern=o,t.EllipsisPattern=u,t.SinkPattern=a,t.ImportPattern=f,t.ArrayPattern=l,t.ObjectPatternElement=c,t.ObjectPattern=h,t.ArgumentsPattern=p,t.SubPattern=d,t.AsPattern=v}),define("khepri-ast/value",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u;s=r(i,"Identifier",[],["name"],function(e,t){var n=this;i.call(n,e),n.name=t}),o=r(i,"Literal",[],["kind","value"],function(e,t,n){var r=this;i.call(r,e),r.kind=t,r.value=n}),u=r(i,"ObjectValue",["key","value"],[],function(e,t,n){var r=this;i.call(r,e),r.key=t,r.value=n}),t.Identifier=s,t.Literal=o,t.ObjectValue=u}),define("khepri/parse/value_parser",["require","exports","bennu/parse","khepri-ast/value","./token_parser"],function(e,t,n,r,i){var s=n.always,o=n.bind,u=n.choice,a=n.Parser,f,l,c,h,p,d,v,m=function(e,t){return o(t,function(t){return s(r.Literal.create(t.loc,e,t.value))})};l=a("Null Literal",m("null",i.nullLiteral)),c=a("Boolean Literal",m("boolean",i.booleanLiteral)),h=a("Numeric Literal",m("number",i.numericLiteral)),p=a("String Literal",m("string",i.stringLiteral)),d=a("Regular Expression Literal",m("regexp",i.regularExpressionLiteral)),f=a("Literal",u(l,c,h,p,d)),v=a("Identifier",o(i.anyIdentifier,function(e){return s(r.Identifier.create(e.loc,e.value))})),t.literal=f,t.nullLiteral=l,t.booleanLiteral=c,t.numericLiteral=h,t.stringLiteral=p,t.regularExpressionLiteral=d,t.identifier=v}),define("khepri/parse/pattern_parser",["require","exports","bennu/parse","bennu/lang","khepri-ast/pattern","./common","./token_parser","./value_parser"],function(e,t,n,r,i,s,o,u){var a=n.always,f=n.attempt,l=n.bind,c=n.binds,h=n.choice,p=n.eager,d=n.either,v=n.expected,m=n.enumeration,g=n.next,y=n.optional,b=n.Parser,w=r.between,E=r.sepBy,S=r.sepBy1,x=r.then,T=s.node,N=s.nodea,C=o.keyword,k=o.punctuator,L=u.identifier,A=u.stringLiteral,O,M,_,D,P,H,B,j,F,I,q,R;M=function(){var e=arguments;return M.apply(undefined,e)},q=function(){var e=arguments;return q.apply(undefined,e)},j=function(){var e=arguments;return j.apply(undefined,e)},R=function(){var e=arguments;return R.apply(undefined,e)};var U=y(null,k(","));_=b("Identifier Pattern",l(L,function(e){return a(i.IdentifierPattern.create(e.loc,e))})),D=b("Sink Pattern",l(C("_"),function(e){return a(i.SinkPattern.create(e.loc))})),P=b("Ellipsis Pattern",l(k("..."),function(e){return a(i.EllipsisPattern.create(e.loc))})),B=b("Array Pattern",T(w(k("["),k("]"),v("array pattern element",p(S(U,M)))),i.ArrayPattern.create));var z=d(N(m(A,g(k(":"),h(B,j,q,_))),i.ObjectPatternElement.create),T(d(q,_),function(e,t){return i.ObjectPatternElement.create(e,t,null)}));j=b("Object Pattern",T(w(k("{"),k("}"),v("object pattern element",p(S(U,z)))),i.ObjectPattern.create)),q=b("As Pattern",N(m(f(x(_,k("#"))),v("object or array pattern",h(B,j))),i.AsPattern.create)),H=b("Import Pattern",g(C("import"),N(m(A,h(D,j,q,_)),i.ImportPattern.create))),M=b("Top Level Pattern",h(P,D,B,j,q,_));var W=p(S(U,d(M,R)));R=b("Sub Pattern",f(N(m(_,w(k("("),k(")"),W)),i.ArgumentsPattern.create)));var X=p(E(U,M)),V=g(k("="),_);F=b("Argument List",N(m(X,y(null,V)),function(e,t,n){return i.ArgumentsPattern.create(e,null,t,n)})),I=b("Arguments Pattern",d(N(m(f(x(y(null,_),k("("))),x(X,k(")")),y(null,V)),i.ArgumentsPattern.create),F)),O=b("Pattern",h(H,M)),t.pattern=O,t.topLevelPattern=M,t.identifierPattern=_,t.sinkPattern=D,t.ellipsisPattern=P,t.importPattern=H,t.arrayPattern=B,t.objectPattern=j,t.argumentList=F,t.argumentsPattern=I,t.asPattern=q,t.subPattern=R}),define("khepri/parse/expression_parser",["require","exports","bennu/parse","bennu/lang","nu-stream/stream","khepri-ast/declaration","khepri-ast/expression","khepri-ast/statement","khepri-ast/pattern","khepri-ast/value","../position","./common","./token_parser","./program_parser","./value_parser","./pattern_parser"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v){var m=n.always,g=n.append,y=n.attempt,b=n.bind,w=n.binds,E=n.choice,S=n.cons,x=n.eager,T=n.either,N=n.enumeration,C=n.expected,k=n.lookahead,L=n.many,A=n.memo,O=n.next,M=n.optional,_=n.RecParser,D=n.Parser,P=r.between,H=r.chainl,B=r.sepBy,j=r.sepBy1,F=r.then,I=i.foldl,q=i.foldr,R=l.SourceLocation,U=c.node,z=c.nodea,W=c.precedence,X=h.keyword,V=h.punctuator,$=d.identifier,J=d.literal,K=d.stringLiteral,Q,G,Y,Z,et,tt,nt,rt,it,st,ot,ut,at,ft,lt,ct,ht,pt,dt,vt,mt,gt,yt,bt,wt,Et,St,xt=function(){var t=arguments,n=e("./program_parser"),r=n.sourceElements;return r.apply(undefined,t)};Et=function(){var e=arguments;return Et.apply(undefined,e)},ct=function(){var e=arguments;return ct.apply(undefined,e)},Q=D("Array Element",Et),G=C("array element",D("Array Elements",x(B(V(","),Q)))),Y=D("Array Literal",U(P(V("["),V("]"),G),o.ArrayExpression.create)),Z=D("Property Name",K),et=D("Property Initializer",z(N(F(Z,V(":")),Et),f.ObjectValue.create)),tt=D("Object Properties",x(B(V(","),et))),nt=D("Object Literal",U(P(V("{"),V("}"),tt),o.ObjectExpression.create));var Tt=v.argumentsPattern,Nt=U(P(V("{"),V("}"),xt),u.BlockStatement.create),Ct=U(Et,function(e,t){return u.BlockStatement.create(e,[u.ReturnStatement.create(null,t)])}),kt=T(Nt,Ct),Lt=D("Function Expression",z(S(M(null,O(X("function"),M(null,$))),O(V("\\"),N(Tt,O(V("->"),C("function body",kt))))),o.FunctionExpression.create)),At=D("Let Binding",z(N(F(C("pattern",v.topLevelPattern),V("=")),C("let binding expression",Et)),s.Binding.create));yt=D("Let Expression",function(){var e=C("let bindings",j(V(","),At)),t=C("let body expression",Et);return z(O(X("let"),N(x(e),O(X("in"),t))),o.LetExpression.create)}()),gt=D("Conditional Expression",z(O(V("?"),N(Et,O(V(":"),C("conditional consequent expression",Et)),O(V(":"),C("conditional alternate expression",Et)))),o.ConditionalExpression.create));var Ot=D("Unary Operator Expression",b(T(X("typeof"),V("void","~","!","++","--")),function(e){var t=e.loc,n=e.value;return m(o.UnaryOperatorExpression.create(t,n))})),Mt=D("Binary Operator Expression",b(T(X("instanceof"),V("*","/","+","-","%","<<",">>",">>>","<",">","<=",">=","==","!=","===","!==","&","^","|","||","&&","\\>","|>")),function(e){var t=e.loc,n=e.value;return m(o.BinaryOperatorExpression.create(t,n))})),_t=D("Ternary Operator Expression",b(V("?"),function(e){var t=e.loc,n=e.value;return m(o.TernaryOperatorExpression.create(t,n))})),Dt=D("Operator Expression",E(Ot,Mt,_t));it=D("Primary Expression",E(yt,gt,$,J,Y,nt,Lt,P(V("("),V(")"),T(y(F(Dt,k(V(")")))),Et)))),ot=D("Argument List",function(){var e=C("argument",Et);return P(V("("),V(")"),x(B(V(","),e)))}()),st=D("Arguments",U(ot,function(e,t){return t.loc=e,t})),lt=D("Accessor",U(O(V("."),T(b($,function(e){return m([e,!1])}),b(P(V("("),V(")"),C("accessor expression",Et)),function(e){return m([e,!0])}))),function(e,t){var n=t[0],r=t[1];return{loc:e,property:n,computed:r}})),ht=D("New Expression",z(O(X("new"),N(C("member expression",ct),C("argument list",st))),o.NewExpression.create));var Pt=function(e,t){return o.MemberExpression.create(R.merge(e.loc,t.loc),e,t.property,t.computed)};ct=D("Member Expression",w(N(T(it,ht),L(lt)),function(e,t){return function(){return e(t.apply(null,arguments))}}(m,I.bind(null,Pt)))),rt=D("Curry Expression",function(){var e=T(st,U(x(N(ct)),function(e,t){return t.loc=e,t})),t=function(e,t){return o.CurryExpression.create(R.merge(e.loc,t.loc),e,t)};return w(N(ct,L(O(V("@"),e))),function(e,t){return function(){return e(t.apply(null,arguments))}}(m,I.bind(null,t)))}());var Ht=T(st,U(x(N(rt)),function(e,t){return t.loc=e,t}));ut=D("Call Expression",function(){var e=function(e,t){return o.CallExpression.create(R.merge(e.loc,t.loc),e,t)};return w(N(rt,L(Ht)),function(e,t){return function(){return e(t.apply(null,arguments))}}(m,I.bind(null,e)))}());var Bt=D("Call Expression",function(){var e=function(e,t){return t.hasOwnProperty("property")?o.MemberExpression.create(R.merge(e.loc,t.loc),e,t.property,t.computed):o.CallExpression.create(R.merge(e.loc,t.loc),e,t)};return w(N(ut,L(T(Ht,lt))),function(e,t){return function(){return e(t.apply(null,arguments))}}(m,I.bind(null,e)))}());dt=D("Unary Operator",T(X("typeof","void"),V("++","--","~","!"))),vt=D("Unary Expression",function(){var e=function(e,t){return o.UnaryExpression.create(R.merge(t.loc,e.loc),t.value,e)};return w(N(L(dt),C("unary argument",Bt)),function(t,n){return m(q(e,n,t))})}());var jt=V("*","/","%"),Ft=V("+","-"),It=V("<<",">>",">>>"),qt=T(V("<",">","<=",">="),X("instanceof")),Rt=V("==","!=","===","!=="),Ut=V("&"),zt=V("^"),Wt=V("|"),Xt=V("&&"),Vt=V("||"),$t=V("\\>","\\>>"),Jt=V("<\\","<<\\"),Kt=V("|>"),Qt=V("<|"),Gt=[{sep:jt,precedence:1,node:o.BinaryExpression},{sep:Ft,precedence:2,node:o.BinaryExpression},{sep:It,precedence:3,node:o.BinaryExpression},{sep:qt,precedence:4,node:o.BinaryExpression},{sep:Rt,precedence:5,node:o.BinaryExpression},{sep:Ut,precedence:6,node:o.BinaryExpression},{sep:zt,precedence:7,node:o.BinaryExpression},{sep:Wt,precedence:8,node:o.BinaryExpression},{sep:$t,precedence:9,node:o.BinaryExpression},{sep:Jt,precedence:9,right:!0,node:o.BinaryExpression},{sep:Kt,precedence:10,node:o.BinaryExpression},{sep:Qt,precedence:10,right:!0,node:o.BinaryExpression},{sep:Vt,precedence:11,node:o.LogicalExpression},{sep:Xt,precedence:12,node:o.LogicalExpression}];mt=D("Binary Expression",W(A(vt),Gt)),Et=mt,pt=D("Left Hand Reference Expression",w(N(A($),A(L(lt))),function(e,t){return function(){return e(t.apply(null,arguments))}}(m,I.bind(null,Pt)))),bt=V("="),wt=D("Assignment Expression",z(g(y(N(pt,bt)),N(C("expression",Et))),function(e,t,n,r){return o.AssignmentExpression.create(e,n.value,t,r)}));var Yt=X("delete"),Zt=D("Delete Expression",z(N(Yt,C("reference expression",pt)),function(e,t,n){return o.UnaryExpression.create(e,t.value,n)}));St=E(Zt,wt,Et),t.arrayElement=Q,t.arrayElements=G,t.arrayLiteral=Y,t.propertyName=Z,t.propertyInitializer=et,t.objectProperties=tt,t.objectLiteral=nt,t.curryExpression=rt,t.primaryExpression=it,t.args=st,t.argumentList=ot,t.callExpression=ut,t.dotAccessor=at,t.bracketAccessor=ft,t.accessor=lt,t.memberExpression=ct,t.newExpression=ht,t.leftHandReferenceExpression=pt,t.unaryOperator=dt,t.unaryExpression=vt,t.binaryExpression=mt,t.conditionalExpression=gt,t.letExpression=yt,t.assignmentOperator=bt,t.assignmentExpression=wt,t.expression=Et,t.topLevelExpression=St}),define("khepri/parse/statement_parser",["require","exports","bennu/parse","bennu/lang","khepri-ast/clause","khepri-ast/declaration","khepri-ast/statement","./common","./token_parser","./expression_parser","./pattern_parser","./value_parser"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h=n.always,p=n.attempt,d=n.binds,v=n.choice,m=n.eager,g=n.either,y=n.enumeration,b=n.expected,w=n.many,E=n.next,S=n.optional,x=n.Parser,T=r.between,N=r.sepBy1,C=r.then,k=u.node,L=u.nodea,A=a.keyword,O=a.punctuator,M=f.expression,_=f.topLevelExpression,D=l.importPattern,P=l.pattern,H=c.identifier,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G;G=function(){var e=arguments;return G.apply(undefined,e)};var Y=O(";"),Z=m(w(G));B=x("Block Statement",k(T(O("{"),O("}"),Z),o.BlockStatement.create)),I=x("Empty Statement",k(O(";"),o.EmptyStatement.create)),Q=x("Debugger Statement",k(E(A("debugger"),O(";")),o.DebuggerStatement.create)),q=x("Expression Statement",k(C(_,Y),o.ExpressionStatement.create)),j=x("Static Statement",function(){var e=k(H,s.StaticDeclarator.create),t=m(N(O(","),e));return k(T(A("static"),Y,t),s.StaticDeclaration.create)}());var et=function(){var e=E(O("="),b("variable initilizer",M)),t=L(y(H,S(null,e)),s.VariableDeclarator.create);return m(N(O(","),t))}();F=x("Variable Statement",k(T(A("var"),Y,et),s.VariableDeclaration.create)),U=x("With Statement",function(){var e=b("pattern",P),t=g(D,L(y(C(e,O("=")),M),s.Binding.create)),n=m(N(O(","),t));return L(E(A("with"),y(n,E(A("in"),B))),o.WithStatement.create)}()),R=x("If Statement",L(E(A("if"),y(T(O("("),O(")"),b("if condition",M)),G,S(null,E(A("else"),G)))),o.IfStatement.create)),$=x("Switch Statement",function(){var e=L(E(A("case"),y(C(M,O(":")),Z)),i.SwitchCase.create),t=k(E(A("default"),E(O(":"),Z)),function(e,t){return i.SwitchCase.create(e,null,t)}),n=m(w(e)),r=T(O("{"),O("}"),d(y(S([],n),S(null,t)),function(e,t){return h(t?e.concat([t]):e)}));return L(E(A("switch"),y(T(O("("),O(")"),b("switch discriminant",M)),r)),o.SwitchStatement.create)}());var tt=x("While Statement",L(E(A("while"),y(T(O("("),O(")"),M),G)),o.WhileStatement.create)),nt=x("Do While Statement",L(E(A("do"),y(C(G,A("while")),T(O("("),O(")"),M),O(";"))),o.DoWhileStatement.create)),rt=x("For Statement",function(){var e=S(null,g(k(E(A("var"),et),s.VariableDeclaration.create),_)),t=S(null,M),n=S(null,_);return L(E(A("for"),y(E(O("("),e),E(O(";"),t),E(O(";"),n),E(O(")"),G))),o.ForStatement.create)}());z=x("Iteration Statement",v(nt,tt,rt)),W=x("Continue Statement",k(E(A("continue"),Y),o.ContinueStatement.create)),X=x("Break Statement",k(E(A("break"),Y),o.BreakStatement.create)),V=x("Return Statement",k(T(A("return"),Y,S(null,M)),o.ReturnStatement.create)),J=x("Throw Statement",k(T(A("throw"),Y,M),o.ThrowStatement.create)),K=x("Try Statement",function(){var e=L(E(A("catch"),y(T(O("("),O(")"),H),B)),i.CatchClause.create),t=E(A("finally"),B);return L(E(A("try"),y(B,S(null,e),S(null,t))),o.TryStatement.create)}()),G=b("statement",x("Statement",v(B,j,F,I,R,U,z,W,X,V,$,J,K,Q,q))),t.blockStatement=B,t.staticStatement=j,t.variableStatement=F,t.emptyStatement=I,t.expressionStatement=q,t.ifStatement=R,t.withStatement=U,t.iterationStatement=z,t.continueStatement=W,t.breakStatement=X,t.returnStatement=V,t.switchStatement=$,t.throwStatement=J,t.tryStatement=K,t.debuggerStatement=Q,t.statement=G}),define("khepri-ast/package",["require","exports","./node"],function(e,t,n){var r=n.defineNode,i=n.Node,s,o,u;o=r(i,"PackageExport",["id","alias"],[],function(e,t,n){var r=this;i.call(r,e),r.id=t,r.alias=n}),u=r(i,"PackageExports",["exports"],[],function(e,t){var n=this;i.call(n,e),n.exports=t}),s=r(i,"Package",["exports","body"],[],function(e,t,n){var r=this;i.call(r,e),r.exports=t,r.body=n}),t.Package=s,t.PackageExport=o,t.PackageExports=u}),define("khepri/parse/package_parser",["require","exports","bennu/parse","bennu/lang","khepri-ast/package","./common","./token_parser","./value_parser","./statement_parser"],function(e,t,n,r,i,s,o,u,a){var f=n.eager,l=n.either,c=n.enumeration,h=n.expected,p=n.next,d=n.optional,v=n.Parser,m=r.between,g=r.sepBy,y=s.node,b=s.nodea,w=o.keyword,E=o.punctuator,S=u.identifier,x,T=function(){var t=arguments,n=e("./statement_parser"),r=n.withStatement;return r.apply(undefined,t)},N=function(){var t=arguments,n=e("./statement_parser"),r=n.blockStatement;return r.apply(undefined,t)},C=v("Package Export",y(S,i.PackageExport.create)),k=v("Package Exports",y(m(E("("),E(")"),f(g(d(null,E(",")),C))),i.PackageExports.create)),L=v("Package Body",l(T,N));x=v("Package",b(p(w("package"),c(h("package export list",k),L)),i.Package.create)),t.khepriPackage=x}),define("khepri/parse/program_parser",["require","exports","bennu/parse","bennu/lang","nu-stream/stream","khepri-ast/program","./common","./statement_parser","./package_parser"],function(e,t,n,r,i,s,o,u,a){var f=n.always,l=n.cons,c=n.eager,h=n.either,p=n.eof,d=n.many,v=n.next,m=n.Parser,g=n.rec,y=r.then,b=i.NIL,w=o.node,E,S,x,T=function(){var t=arguments,n=e("./statement_parser"),r=n.statement;return r.apply(undefined,t)},N=function(){var t=arguments,n=e("./package_parser"),r=n.khepriPackage;return r.apply(undefined,t)};E=T,S=c(d(E)),x=m("Program",w(h(y(N,p),c(g(function(e){return h(v(p,f(b)),l(E,e))}))),s.Program.create)),t.sourceElement=E,t.sourceElements=S,t.program=x}),define("khepri/parse/parser",["require","exports","bennu/parse","nu-stream/stream","../position","./program_parser"],function(e,t,n,r,i,s){var o=r.first,u=r.filter,a=r.isEmpty,f=r.rest,l=r.NIL,c=r.from,h=i.SourceLocation,p=i.SourcePosition,d=s.program,v,m,g,y,b;v=u.bind(null,function(e){switch(e.type){case"Whitespace":case"LineTerminator":case"Comment":return!1;default:return!0}}),m=function(e,t){var n=this;n.tokenPosition=e,n.sourcePosition=t},m.prototype=new n.Position,m.prototype.constructor=m,m.initial=new m(n.Position.initial,p.initial),m.prototype.increment=function(e,t){var n=this;return new m(n.tokenPosition.increment(e),t)},m.prototype.toString=function(){var e=this;return""+e.sourcePosition},m.prototype.compare=function(e){var t=this;return t.tokenPosition.compare(e.tokenPosition)},g=function(e,t,r){var i=this;n.ParserState.call(i,e,t),i._prevEnd=r},g.prototype=new n.ParserState,g.initial=new g(l,m.initial,p.initial),g.prototype.setInput=function(e){var t=this;return new g(e,t.position,t._prevEnd)},g.prototype.setPosition=function(e){var t=this;return new g(t.input,e,t._prevEnd)},g.prototype.next=function(e){var t=this;if(!t._next){var n=f(t.input),r=a(n)?e.loc.end:o(n).loc.start,i=new g(n,t.position.increment(e,r),t.loc.end);t._next=function(t,n,r){return r(e,i,n)}}return t._next},Object.defineProperty(g.prototype,"loc",{get:function(){var e=this;return a(e.input)?new h(e._prevEnd,e._prevEnd):o(e.input).loc}}),b=function(e){return n.runState(d,new g(v(e),m.initial))},y=function(e,t){return function(n){return e(t(n))}}(b,c),t.parserStream=v,t.ParserPosition=m,t.ParserState=g,t.parseInput=y,t.parseStream=b}),define("ecma-ast/serialization",["require","exports","./node"],function(e,t,n){var r=n.Node,i,s,o,u=Object.keys,a=Function.prototype.call.bind(Array.prototype.map),f=Function.prototype.call.bind(Array.prototype.reduce),l=function(e){return e},c={};i=function(e,t){c[e]=t};var h=function(e,t,n){return e?Array.isArray(e)?a(e,function(e){return h(e,t,n)}):e instanceof r?{type:e.type,loc:t(e.loc),ud:n(e.ud),children:f(e.children,function(r,i){return r[i]=h(e[i],t,n),r},{}),attributes:f(e.attributes,function(t,n){return t[n]=e[n],t},{})}:e:e};s=function(e,t,n){var r=h(e,t||l,n||l);return{version:"2.1.0",kind:"ecma",program:r}};var p=function(e,t,r){if(!e)return e;if(Array.isArray(e))return a(e,function(e){return p(e,t,r)});var i=c[e.type];if(!i)return e;var s=t(e.loc),o=r(e.ud),l=f(u(e.children),function(n,i){return n[i]=p(e.children[i],t,r),n},{}),h=f(u(e.attributes),function(t,n){return t[n]=e.attributes[n],t},{});return n.construct(i.prototype,s,o,l,h)};o=function(e,t,n){return p(e.program,t||l,n||l)},t.registerNode=i,t.serialize=s,t.unserialize=o}),define("ecma-ast/node",["require","exports","./serialization"],function(e,t,n){var r=n.registerNode,i,s,o,u,a,f,l,c,h,p,d=function(){var e=function(e){return e};return function(t,n){return t.concat([].map.call(n,e))}}(),v=Object.keys,m=Function.prototype.call.bind(Array.prototype.map),g=Function.prototype.call.bind(Array.prototype.reduce),y=function(e){var t=Object.create(Object.getPrototypeOf(e));return Object.getOwnPropertyNames(e).forEach(function(n){var r=this;t[n]=e[n]}),t},b=function(e,t,n){return Object.defineProperty(y(e),t,n)};i=function(e,t){var n=this;Object.defineProperties(n,{loc:{value:e,enumerable:!1},ud:{value:t||null,enumerable:!1}})},s=function(e,t,n,r,i){var s={};return Object.keys(r).forEach(function(e){s[e]={value:r[e],enumerable:!0,configurable:!0}}),e.children.forEach(function(e){s[e]=s[e]||{value:null,enumerable:!0,configurable:!0}}),Object.keys(i).forEach(function(e){s[e]={value:i[e],enumerable:!0,configurable:!0}}),s.loc={value:t,enumerable:!1},s.ud={value:n,enumerable:!1},Object.create(e,s)},o=function(e,t,n){return s(Object.getPrototypeOf(e),e.loc,e.ud,t,n)},u=function(e,t,n){var r={},i={};return e.children.forEach(function(t){r[t]=e[t]}),t&&Object.keys(t).forEach(function(e){r[e]=t[e]}),e.attributes.forEach(function(t){i[t]=e[t]}),n&&Object.keys(n).forEach(function(e){i[e]=n[e]}),o(e,r,i)},a=function(e,t){return s(Object.getPrototypeOf(e),t,e.ud,g(e.children,function(t,n){return t[n]=e[n],t},{}),g(e.attributes,function(t,n){return t[n]=e[n],t},{}))},f=function(e,t){return s(Object.getPrototypeOf(e),e.loc,t,g(e.children,function(t,n){return t[n]=e[n],t},{}),g(e.attributes,function(t,n){return t[n]=e[n],t},{}))},l=function(e,t){return e.ud?e.ud[t]:null},c=function(e,t,n){return f(e,b(e.ud||{},t,{value:n(l(e,t)),enumerable:!0}))},h=function(e,t,n){return c(e,t,function(){return n})},p=function(t,n,r,i,s){return s.type=n,s.prototype=new t,s.prototype.constructor=s,s.prototype.children=r,s.prototype.attributes=i,s.prototype.type=s.type,s.create=function(){var e=arguments;return new(s.bind.apply(s,d([null],e)))},e("./serialization").registerNode(n,s),s},t.Node=i,t.construct=s,t.reconstruct=o,t.modify=u,t.setLoc=a,t.setUserData=f,t.getData=l,t.modifyData=c,t.setData=h,t.defineNode=p}),define("ecma-ast/clause",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u=function(){};u.prototype=new r,s=i(u,"SwitchCase",["test","consequent"],[],function(e,t,n){var i=this;r.call(i,e),i.test=t||null,i.consequent=n}),o=i(u,"CatchClause",["param","body"],[],function(e,t,n){var i=this;r.call(i,e),i.param=t,i.body=n}),t.SwitchCase=s,t.CatchClause=o}),define("ecma-ast/declaration",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u,a;s=function(){},s.prototype=new r,o=i(s,"FunctionDeclaration",["params","body"],[],function(e,t,n,i){var s=this;r.call(s,e),s.id=t,s.params=n,s.body=i}),u=i(s,"VariableDeclaration",["declarations"],[],function(e,t){var n=this;r.call(n,e),n.declarations=t}),a=i(s,"VariableDeclarator",["id","init"],[],function(e,t,n){var i=this;r.call(i,e),i.id=t,i.init=n||null}),t.Declaration=s,t.FunctionDeclaration=o,t.VariableDeclaration=u,t.VariableDeclarator=a}),define("ecma-ast/expression",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b;s=function(){var e=this},s.prototype=new r,o=i(s,"ThisExpression",[],[],function(e){var t=this;r.call(t,e)}),u=i(s,"SequenceExpression",["expressions"],[],function(e,t){var n=this;r.call(n,e),n.expressions=t}),a=i(s,"UnaryExpression",["argument"],["operator"],function(e,t,n){var i=this;r.call(i,e),i.operator=t,i.argument=n}),f=i(s,"BinaryExpression",["left","right"],["operator"],function(e,t,n,i){var s=this;r.call(s,e),s.operator=t,s.left=n,s.right=i}),l=i(s,"AssignmentExpression",["left","right"],["operator"],function(e,t,n,i){var s=this;r.call(s,e),s.operator=t,s.left=n,s.right=i}),c=i(s,"UpdateExpression",["argument"],["operator","prefix"],function(e,t,n,i){var s=this;r.call(s,e),s.operator=t,s.argument=n,s.prefix=i}),h=i(s,"LogicalExpression",["left","right"],["operator"],function(e,t,n,i){var s=this;r.call(s,e),s.operator=t,s.left=n,s.right=i}),p=i(s,"ConditionalExpression",["test","consequent","alternate"],[],function(e,t,n,i){var s=this;r.call(s,e),s.test=t,s.consequent=n,s.alternate=i}),d=i(s,"NewExpression",["callee","args"],[],function(e,t,n){var i=this;r.call(i,e),i.callee=t,i.args=n}),v=i(s,"CallExpression",["callee","args"],[],function(e,t,n){var i=this;r.call(i,e),i.callee=t,i.args=n}),m=i(s,"MemberExpression",["object","property"],["computed"],function(e,t,n,i){var s=this;r.call(s,e),s.object=t,s.property=n,s.computed=i}),g=i(s,"FunctionExpression",["id","params","body"],[],function(e,t,n,i){var s=this;r.call(s,e),s.id=t||null,s.params=n,s.body=i}),y=i(s,"ArrayExpression",["elements"],[],function(e,t){var n=this;r.call(n,e),n.elements=t}),b=i(s,"ObjectExpression",["properties"],[],function(e,t){var n=this;r.call(n,e),n.properties=t}),t.Expression=s,t.ThisExpression=o,t.SequenceExpression=u,t.UnaryExpression=a,t.BinaryExpression=f,t.AssignmentExpression=l,t.UpdateExpression=c,t.LogicalExpression=h,t.ConditionalExpression=p,t.NewExpression=d,t.CallExpression=v,t.MemberExpression=m,t.FunctionExpression=g,t.ArrayExpression=y,t.ObjectExpression=b}),define("ecma-ast/program",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s;s=i(r,"Program",["body"],[],function(e,t){var n=this;r.call(n,e),n.body=t}),t.Program=s}),define("ecma-ast/statement",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S;s=function(){var e=this},s.prototype=new r,f=i(s,"EmptyStatement",[],[],function(e){var t=this;r.call(t,e)}),o=i(s,"DebuggerStatement",[],[],function(e){var t=this;r.call(t,e)}),u=i(s,"BlockStatement",["body"],[],function(e,t){var n=this;r.call(n,e),n.body=t}),a=i(s,"ExpressionStatement",["expression"],[],function(e,t){var n=this;r.call(n,e),n.expression=t}),l=i(s,"IfStatement",["test","consequent","alternate"],[],function(e,t,n,i){var s=this;r.call(s,e),s.test=t,s.consequent=n,s.alternate=i||null}),c=i(s,"LabeledStatement",["body"],[],function(e,t,n){var i=this;r.call(i,e),i.label=t,i.body=n}),h=i(s,"BreakStatement",["label"],[],function(e,t){var n=this;r.call(n,e),n.label=t||null}),p=i(s,"ContinueStatement",["label"],[],function(e,t){var n=this;r.call(n,e),n.label=t||null}),d=i(s,"WithStatement",["object","body"],[],function(e,t,n){var i=this;r.call(i,e),i.object=t,i.body=n}),v=i(s,"SwitchStatement",["discriminant","cases"],[],function(e,t,n){var i=this;r.call(i,e),i.discriminant=t,i.cases=n}),m=i(s,"ReturnStatement",["argument"],[],function(e,t){var n=this;r.call(n,e),n.argument=t||null}),g=i(s,"ThrowStatement",["argument"],[],function(e,t){var n=this;r.call(n,e),n.argument=t}),y=i(s,"TryStatement",["block","handler","finalizer"],[],function(e,t,n,i){var s=this;r.call(s,e),s.block=t,s.handler=n,s.finalizer=i}),b=i(s,"WhileStatement",["test","body"],[],function(e,t,n){var i=this;r.call(i,e),i.test=t,i.body=n}),w=i(s,"DoWhileStatement",["body","test"],[],function(e,t,n){var i=this;r.call(i,e),i.test=n,i.body=t}),E=i(s,"ForStatement",["init","test","update","body"],[],function(e,t,n,i,s){var o=this;r.call(o,e),o.init=t||null,o.test=n||null,o.update=i||null,o.body=s}),S=i(s,"ForInStatement",["left","right","body"],[],function(e,t,n,i){var s=this;r.call(s,e),s.left=t,s.right=n,s.body=i}),t.Statement=s,t.DebuggerStatement=o,t.BlockStatement=u,t.ExpressionStatement=a,t.EmptyStatement=f,t.IfStatement=l,t.LabeledStatement=c,t.BreakStatement=h,t.ContinueStatement=p,t.WithStatement=d,t.SwitchStatement=v,t.ReturnStatement=m,t.ThrowStatement=g,t.TryStatement=y,t.WhileStatement=b,t.DoWhileStatement=w,t.ForStatement=E,t.ForInStatement=S}),define("ecma-ast/value",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u,a,f;s=i(r,"Identifier",[],["name"],function(e,t){var n=this;r.call(n,e),n.name=t}),o=i(r,"Literal",[],["kind","value"],function(e,t,n){var i=this;r.call(i,e),i.kind=t,i.value=n}),u=i(r,"ObjectValue",["key","value"],[],function(e,t,n){var i=this;r.call(i,t,n),i.key=t,i.value=n}),a=i(r,"ObjectGetter",["key","value"],[],function(e,t,n){var i=this;r.call(i,t,n),i.key=t,i.value=n}),f=i(r,"ObjectSetter",["key","value"],[],function(e,t,n){var i=this;r.call(i,t,n),i.key=t,i.value=n}),t.Identifier=s,t.Literal=o,t.ObjectValue=u,t.ObjectGetter=a,t.ObjectSetter=f}),define("khepri/compile/package_manager/amd",["require","exports","khepri-ast/declaration","khepri-ast/expression","khepri-ast/pattern","khepri-ast/statement","khepri-ast/value"],function(e,t,n,r,i,s,o){var u,a,f=Function.prototype.call.bind(Array.prototype.concat),l=Function.prototype.call.bind(Array.prototype.map),c=function(e){return e.split("::").join("/")};a=function(e){var t=c(e);return r.CallExpression.create(null,o.Identifier.create(null,"require"),[o.Literal.create(null,"string",t)])},u=function(e,t,u,a,h){var p=n.VariableDeclaration.create(null,l(t,function(e){return n.VariableDeclarator.create(null,o.Identifier.create(null,e))})),d=l(t,function(e){return s.ExpressionStatement.create(null,r.AssignmentExpression.create(null,"=",r.MemberExpression.create(null,o.Identifier.create(null,"exports"),o.Identifier.create(null,e)),o.Identifier.create(null,e)))}),v=r.FunctionExpression.create(null,null,i.ArgumentsPattern.create(null,null,f(i.IdentifierPattern.create(null,o.Identifier.create(null,"require")),i.IdentifierPattern.create(null,o.Identifier.create(null,"exports")),l(u,function(e){return a([e.from.value])}))),s.BlockStatement.create(h.loc,f(s.ExpressionStatement.create(null,o.Literal.create(null,"string","use strict")),p,h,d)));return s.ExpressionStatement.create(e,r.CallExpression.create(e,o.Identifier.create(null,"define"),[r.ArrayExpression.create(null,f(o.Literal.create(null,"string","require"),o.Literal.create(null,"string","exports"),l(u,function(e){return o.Literal.create(null,"string",c(e.from.value))}))),v]))},t.definePackage=u,t.importPackage=a}),define("khepri/compile/package_manager/node",["require","exports","khepri-ast/declaration","khepri-ast/expression","khepri-ast/statement","khepri-ast/value"],function(e,t,n,r,i,s){var o,u,a=Function.prototype.call.bind(Array.prototype.concat),f=Function.prototype.call.bind(Array.prototype.map);u=function(e){var t=e.split("::");return t.slice(1).reduce(function(e,t){return r.MemberExpression.create(null,e,s.Literal.create(null,"string",t),!0)},r.CallExpression.create(null,s.Identifier.create(null,"require"),[s.Literal.create(null,"string",t([0]))]))},o=function(e,t,o,l,c){var h=n.VariableDeclaration.create(null,f(t,function(e){return n.VariableDeclarator.create(null,s.Identifier.create(null,e))})),p=f(t,function(e){return i.ExpressionStatement.create(null,r.AssignmentExpression.create(null,"=",r.MemberExpression.create(null,s.Identifier.create(null,"exports"),s.Identifier.create(null,e)),s.Identifier.create(null,e)))});return i.BlockStatement.create(c.loc,[i.ExpressionStatement.create(null,s.Literal.create(null,"string","use strict")),i.WithStatement.create(null,f(o,function(e){return n.Binding.create(null,e.pattern,u(e.from.value))}),i.BlockStatement.create(null,a(h,c.body,p)))])},t.definePackage=o,t.importPackage=u}),define("khepri/compile/transform",["require","exports","ecma-ast/clause","ecma-ast/declaration","ecma-ast/expression","ecma-ast/node","ecma-ast/program","ecma-ast/statement","ecma-ast/value","khepri-ast/clause","khepri-ast/declaration","khepri-ast/expression","khepri-ast/node","khepri-ast/pattern","khepri-ast/program","khepri-ast/statement","khepri-ast/value","./package_manager/amd","./package_manager/node"],function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y){var b=h.setUserData,w,E,S=Function.prototype.call.bind(Array.prototype.concat),x=Function.prototype.call.bind(Array.prototype.reduce),T=function(e,t){return Array.prototype.filter.call(t,e)},N=function(e,t){return Array.prototype.map.call(t,e)},C=function(e){return Array.isArray(e)?x(e,function(e,t,n){return e.concat(t)},[]):e},k=function(e){if(e&&e.length&&e[0].type==="ExpressionStatement"){var t=e[0].expression;return t&&t.type==="Literal"&&t.kind==="string"&&t.value==="use strict"}return!1},L,A,O,M=function(e,t){return a.Identifier.create(e,t)},_=function(e,t){return a.Literal.create(e,"string",t)},D=function(e){return a.Literal.create(e,"null",null)},P=function(e,t){return r.VariableDeclaration.create(e,A(t))},H=function(e,t,n){return r.VariableDeclarator.create(e,A(t),A(n))},B=function(){var e=function(e,t,n,r){var i=c.MemberExpression.create(null,e,n,!0);return t?C(B(i,t,r)):r(M(null,n.value),i)};return function(t,n,r){switch(n.type){case"IdentifierPattern":return r(M(null,n.id.name),t);case"AsPattern":return S(r(n.id,t),C(B(n.id,n.target,r)));case"ObjectPattern":return N(function(t){var i=t.target,s=t.key;return C(e(n.ud.id,i,s,r))},n.elements);default:return[]}}}(),j=function(){var e=H.bind(null,null);return function(t,n){return C(B(n,t,e))}}(),F=function(e,t){return M(e,t)},I=function(e,t,n){return i.CallExpression.create(e,A(t),A(n))},q=function(e,t,n,r){return i.MemberExpression.create(e,A(t),A(n),r)},R=function(e,t){return u.BlockStatement.create(e,A(t))};L=function(e,t){return u.ExpressionStatement.create(e,A(t))};var U=function(e,t){return u.ReturnStatement.create(e,A(t))},z=function(e,t,n){var r=C(N(function(e){var t=e.type==="ImportPattern"?O.importPackage(e.from.value):e.value;return j(e.pattern,t)},t)),i=P(null,r);return R(e,S(i,n.body))},W=function(e,t,n,r){var s=A(T(function(e){return e.type!=="EllipsisPattern"},n.elements)),o=C(N(function(e){switch(e.type){case"IdentifierPattern":return[];case"AsPattern":return B(A(e.id),e.target,H.bind(null,null));default:return B(A(e),e,H.bind(null,null))}},n.elements)),u=S(n.self?H(null,A(n.self),i.ThisExpression.create(null)):[],n.id?H(null,A(n.id),M(null,"arguments")):[]),a=k(r.body),f=S(o,u);return i.FunctionExpression.create(e,A(t),s,R(r.loc,S(a?v.ExpressionStatement.create(null,m.Literal.create(null,"string","use strict")):[],P(null,f),function(){var e=A(r).body;return a?e.slice(1):e}())))},X=function(e,t,n){return I(e,W(null,null,p.ArgumentsPattern.create(null,null,[]),R(null,[z(null,t,R(null,[U(null,n)]))])),[])},V=function(e,t,n){return I(null,q(null,t,M(null,"bind")),S(D(null),n))},$=function(e,t,n,r){return i.AssignmentExpression.create(e,t,A(n),A(r))},J=function(e,t,n){return I(e,n,[t])},K=function(e,t,n){return I(e,W(null,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"f")),p.IdentifierPattern.create(null,M(null,"g"))]),R(null,[U(null,W(null,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"x"))]),R(null,[U(null,I(null,M(null,"f"),[I(null,M(null,"g"),[M(null,"x")])]))])))])),[t,n])},Q=function(e,t,n){return I(e,W(null,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"f")),p.IdentifierPattern.create(null,M(null,"g"))]),R(null,[U(null,W(null,null,p.ArgumentsPattern.create(null,null,[]),R(null,[U(null,I(null,M(null,"f"),[I(null,q(null,M(null,"g"),M(null,"apply")),[D(null),M(null,"arguments")])]))])))])),[t,n])},G=function(e,t,n){var r=n.type==="WithStatement"?T(function(e){return e.type==="ImportPattern"},n.bindings):[],i=N(function(e){return e.id.name},t.exports),s=x(r,function(e,t){return e[t.from.value]=t.pattern,e},{}),o=n.type==="WithStatement"?v.WithStatement.create(null,T(function(e){return e.type!=="ImportPattern"},n.bindings),n.body):n;return A(O.definePackage(e,i,r,s,o))},Y={},Z=function(e,t){Y[e]=t};Z("VariableDeclaration",function(e){return P(e.loc,e.declarations)}),Z("VariableDeclarator",function(e){return H(e.loc,e.id,e.init)}),Z("StaticDeclaration",function(e){return u.EmptyStatement.create(e.loc)}),Z("CatchClause",function(e){return n.CatchClause.create(e.loc,A(e.param),A(e.body))}),Z("SwitchCase",function(e){return n.SwitchCase.create(e.loc,A(e.test),A(e.consequent))}),Z("BlockStatement",function(e){return R(e.loc,e.body)}),Z("ExpressionStatement",function(e){return L(e.loc,e.expression)}),Z("IfStatement",function(e){return u.IfStatement.create(e.loc,A(e.test),A(e.consequent),A(e.alternate))}),Z("WithStatement",function(e){return z(e.loc,e.bindings,e.body)}),Z("SwitchStatement",function(e){return u.SwitchStatement.create(e.loc,A(e.discriminant),A(e.cases))}),Z("ReturnStatement",function(e){return U(e.loc,e.argument)}),Z("ThrowStatement",function(e){return u.ThrowStatement.create(e.loc,A(e.argument))}),Z("BreakStatement",function(e){return u.BreakStatement.create(e.loc,null)}),Z("ContinueStatement",function(e){return u.ThrowStatement.create(e.loc,null)}),Z("TryStatement",function(e){return u.TryStatement.create(e.loc,A(e.block),A(e.handler),A(e.finalizer))}),Z("WhileStatement",function(e){return u.WhileStatement.create(e.loc,A(e.test),A(e.body))}),Z("DoWhileStatement",function(e){return u.DoWhileStatement.create(e.loc,A(e.body),A(e.test))}),Z("ForStatement",function(e){return u.ForStatement.create(e.loc,A(e.init),A(e.test),A(e.update),A(e.body))}),Z("AssignmentExpression",function(e){return $(e.loc,e.operator,e.left,e.right)}),Z("UnaryExpression",function(e){var t=e.operator;switch(t){case"++":t="+";break;case"--":t="-"}return i.UnaryExpression.create(e.loc,t,A(e.argument))}),Z("BinaryExpression",function(e){switch(e.operator){case"\\>":return K(e.loc,e.right,e.left);case"\\>>":return Q(e.loc,e.right,e.left);case"<\\":return K(e.loc,e.left,e.right);case"<<\\":return Q(e.loc,e.left,e.right);case"|>":return J(e.loc,e.left,e.right);case"<|":return J(e.loc,e.right,e.left);default:return i.BinaryExpression.create(e.loc,e.operator,A(e.left),A(e.right))}}),Z("LogicalExpression",function(e){return i.LogicalExpression.create(e.loc,e.operator,A(e.left),A(e.right))}),Z("ConditionalExpression",function(e){return i.ConditionalExpression.create(e.loc,A(e.test),A(e.consequent),A(e.alternate))}),Z("NewExpression",function(e){return i.NewExpression.create(e.loc,A(e.callee),A(e.args))}),Z("CallExpression",function(e){return I(e.loc,e.callee,e.args)}),Z("MemberExpression",function(e){return i.MemberExpression.create(e.loc,A(e.object),A(e.property),e.computed)}),Z("LetExpression",function(e){return X(e.loc,e.bindings,e.body)}),Z("CurryExpression",function(e){return V(e.loc,e.base,e.args)}),Z("UnaryOperatorExpression",function(e){return W(e.loc,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"x"))]),R(null,[U(null,c.UnaryExpression.create(null,e.op,M(null,"x")))]))}),Z("BinaryOperatorExpression",function(e){var t=e.op==="||"||e.op==="&&"?c.LogicalExpression:c.BinaryExpression;return W(e.loc,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"x")),p.IdentifierPattern.create(null,M(null,"y"))]),R(null,[U(null,t.create(null,e.op,M(null,"x"),M(null,"y")))]))}),Z("TernaryOperatorExpression",function(e){return W(e.loc,null,p.ArgumentsPattern.create(null,null,[p.IdentifierPattern.create(null,M(null,"x")),p.IdentifierPattern.create(null,M(null,"y")),p.IdentifierPattern.create(null,M(null,"z"))]),R(null,[U(null,c.ConditionalExpression.create(null,M(null,"x"),M(null,"y"),M(null,"z")))]))}),Z("FunctionExpression",function(e){return W(e.loc,e.id,e.params,e.body)}),Z("ArrayExpression",function(e){return i.ArrayExpression.create(e.loc,A(e.elements))}),Z("ObjectExpression",function(e){return i.ObjectExpression.create(e.loc,A(e.properties))}),Z("ObjectValue",function(e){return a.ObjectValue.create(e.loc,A(e.key),A(e.value))}),Z("ArgumentsPattern",function(e){return M(e.loc,e.id.name)}),Z("IdentifierPattern",function(e){return M(e.loc,e.id.name)}),Z("AsPattern",function(e){return A(e.id)}),Z("ArrayPattern",function(e){return A(e.ud.id)}),Z("ObjectPattern",function(e){return A(e.ud.id)}),Z("EllipsisPattern",function(e){return e.ud&&e.ud.id?A(e.ud.id):null}),Z("SinkPattern",function(e){return e.ud&&e.ud.id?A(e.ud.id):null}),Z("Program",function(e){return o.Program.create(e.loc,Array.isArray(e.body)?A(e.body):[A(e.body)])}),Z("Package",function(e){return G(e.loc,e.exports,e.body)}),A=function(e){if(!e)return e;if(Array.isArray(e))return N(A,e);if(e instanceof h.Node){var t=Y[e.type];return t?t(e):e}return e},w=function(t){var n=t.options,r=t.ast,i=e("./package_manager/amd"),s=e("./package_manager/node");return O=i,n.package_manager==="node"&&(O=s),{options:n,ast:A(r)}},t.transform=w,t.transformStage=E}),define("nu-stream/select",["require","exports","./stream"],function(e,t,n){var r=n.NIL,i=n.first,s=n.isEmpty,o=n.map,u=n.stream,a=n.rest,f=n.indexed,l,c,h,p,d=function(e){var t=e[0],n=e[1];return n},v=function(e){var t=e[0],n=e[1];return t};l=function(e,t){return s(t)?t:function(){var n=i(t);return e(n)?u(n,l.bind(null,e,a(t))):r}()},c=function(e,t){return isNaN(e)||e<0?t:o(d,l(function(e,t){return function(n){return e(t(n))}}(function(e,t){return e>t}.bind(null,e),v),f(t)))},h=function(e,t){for(var n=t;!s(n);n=a(n))if(!e(i(n)))return n;return r},p=function(e,t){return isNaN(e)||e<=0?t:o(d,h(function(e,t){return function(n){return e(t(n))}}(function(e,t){return e>t}.bind(null,e),v),f(t)))},t.takeWhile=l,t.take=c,t.skipWhile=h,t.skip=p}),define("neith/zipper",["require","exports","nu-stream/stream","nu-stream/select"],function(e,t,n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,n=n,R=n.append,U=n.cons,z=n.first,W=n.rest,X=n.isEmpty,V=n.NIL,$=n.foldl,J=n.reverse,r=r,K=r.skip,Q=function(e){return function(t,n){return e(n,t)}},G=function(e,t,n){this.loc=e,this.children=t,this.constructNode=n};G.setLoc=function(e,t){return new G(t,e.children,e.constructNode)};var Y=function(e,t,n,r,i){this.focus=e,this.parent=t,this.path=n,this.left=r,this.right=i};Y.empty=new Y(null,null,V,V,V),Y.setFocus=function(e,t){return new Y(t,e.parent,e.path,e.left,e.right)},Y.setLeft=function(e,t){return new Y(e.focus,e.parent,e.path,t,e.right)},Y.setRight=function(e,t){return new Y(e.focus,e.parent,e.path,e.left,t)},Y.setSurround=function(e,t,n,r){return Y.setRight(Y.setLeft(Y.setFocus(e,n),t),r)};var Z=function(e){return e.loc},et=function(e,t){return G.setLoc(e,t)},tt=function(e,t){return et(e,t(Z(e)))},nt=function(e,t){return tt(e,function(e){return Y.setFocus(e,t)})},rt=function(e){return Z(e).path},it=function(e,t){return U(e,rt(t))},st=function(e,t,n){return e.constructNode(t,n)},ot=function(e){return st(e,a(e).focus,R(J(s(e)),U(L(e),V),o(e)))};L=function(e){return Z(e).focus},i=function(e){return U(L(e),rt(e))},s=function(e){return Z(e).left},o=function(e){return Z(e).right},u=function(e){return e.children(L(e))},a=function(e){return Z(e).parent},f=function(e,t){return function(n){return e(t(n))}}(function(e,t){return function(n){return e(t(n))}}(function(e){return!e},X),u),l=function(e,t){return function(n){return e(t(n))}}(function(e,t){return e!==t}.bind(null,null),a),c=function(e,t){return function(n){return e(t(n))}}(function(e){return!e},l),h=l,p=function(e,t){return function(n){return e(t(n))}}(function(e){return!e},f),d=function(e,t){return function(n){return e(t(n))}}(X,s),v=function(e,t){return function(n){return e(t(n))}}(X,o),m=function(e){return c(e)?null:et(e,Y.setFocus(a(e),ot(e)))},g=function(e){return p(e)?null:et(e,function(){var t=u(e);return new Y(z(t),Z(e),it(L(e),e),V,W(t))}.call(this))},y=function(e){return d(e)?null:et(e,function(){var t=s(e);return Y.setSurround(Z(e),W(t),z(t),U(L(e),o(e)))}.call(this))},b=function(e){return v(e)?null:et(e,function(){var t=o(e);return Y.setSurround(Z(e),U(L(e),s(e)),z(t),W(t))}.call(this))},w=function(e){var t=m(e);return t?w(t):e},E=function(e){var t=y(e);return t?E(t):e},S=function(e){var t=b(e);return t?S(t):e},x=function(e){var t=g(e);return t?x(t):e},T=function(e){var t=g(e);return t?T(S(t)):e},N=function(e){var t=m(e);return t?b(t)||N(t):t},C=function(e){return g(e)||b(e)||N(e)},k=function(e){var t=y(e);return t?T(t):m(e)},A=Q(nt),O=function(e,t){return A(e(L(t)),t)},M=function(e){return v(e)?d(e)?l(e)?ot(e):null:P(V,y(e)):D(K.bind(null,2),b(e))},_=function(e,t){return tt(t,function(t){return Y.setLeft(t,e)})},D=function(e,t){return _(e(s(t)),t)},P=function(e,t){return tt(t,function(t){return Y.setRight(t,e)})},H=function(e,t){return P(e(o(t)),t)},B=function(e,t){return D(U.bind(null,e),t)},j=function(e,t){return H(U.bind(null,e),t)},F=function(e,t){return f(t)?m(B(e,g(t))):A(st(t,L(t),U(e,V)),t)},I=function(e,t){return f(t)?m(j(e,S(g(t)))):F(e,t)},q=function(e,t,n){return new G(Y.setFocus(Y.empty,n),e,t)},t.path=i,t.lefts=s,t.rights=o,t.children=u,t.parent=a,t.hasChildren=f,t.hasParent=l,t.isRoot=c,t.isChild=h,t.isLeaf=p,t.isFirst=d,t.isLast=v,t.up=m,t.down=g,t.left=y,t.right=b,t.root=w,t.leftmost=E,t.rightmost=S,t.leftLeaf=x,t.rightLeaf=T,t.nextUpDfs=N,t.nextDfs=C,t.prevDfs=k,t.extract=L,t.replace=A,t.modify=O,t.remove=M,t.setLefts=_,t.modifyLefts=D,t.setRights=P,t.modifyRights=H,t.insertLeft=B,t.insertRight=j,t.insertChild=F,t.appendChild=I,t.zipper=q}),define("neith/tree",["require","exports","./zipper","nu-stream/stream","nu-stream/select"],function(e,t,n,r,i){var s=n.right,o=n.left,u=n.up,a=n.down,f=r.cons,l=r.first,c=r.foldl,h=r.indexed,p=r.isStream,d=r.map,v=r.toArray,m=i.skip,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I=function(e){return p(e)?e:r.from(e)},q=function(e,t){return c(function(t,n){var r=n[0],i=n[1];return t>=0?t:i===e?r:t},-1,h(t))};g=function(e,t){return{key:e,value:t}},y=function(e){var t=e.key;return t},b=function(e){var t=e.value;return t},S=function(e,t){return function(n){return e(t(n))}}(b,n.extract),x=function(e,t){return function(n){return e(t(n))}}(y,n.extract),E=function(e,t){return function(n){return e(t(n))}}(d.bind(null,b),n.path),w=function(e,t){return function(n){return e(t(n))}}(d.bind(null,y),n.path),N=function(e,t){return function(n){return e(t(n))}}(b,n.parent),C=function(e,t){return function(n){return e(t(n))}}(d.bind(null,b),n.children),T=function(e,t){var n=k(e,t);return n?S(n):null};var R=function(e,t){return t<=0?e:R(s(e),t-1)};L=function(e,t){var n=a(t);return n?R(n,e):null},k=function(e,t){return t?function(){var r=n.children(t),i=q(e,d(y,r));return i===-1?null:L(i,t)}():null},A=function(e,t){return k(e,u(t))},O=function(e,t){return n.replace(g(x(t),e),t)},M=function(e,t){return O(e(S(t)),t)},_=function(e,t){return n.replace(g(e,S(t)),t)},D=function(e,t){return _(e(x(t)),t)},P=function(e,t,r){return n.insertLeft(g(e,t),r)},H=function(e,t,r){return n.insertRight(g(e,t),r)},B=function(e,t,r){return n.insertChild(g(e,t),r)},j=function(e,t,r){return n.appendChild(g(e,t),r)};var U=function(e,t){var n=t.key,r=t.value;return e.hasOwnProperty(n)||(e[n]=r),e};F=function(e,t,r,i){var s=function(n){var r=n.value;return d(function(e){return g(e,t(r,e))},I(e(r)))},o=function(e,t){return g(y(e),r(b(e),t,function(){return c(U,{},t)}))};return n.zipper(s,o,g(null,i))},t.Pair=g,t.pairKey=y,t.pairValue=b,t.edgePath=w,t.nodePath=E,t.node=S,t.edge=x,t.childNode=T,t.parentNode=N,t.childNodes=C,t.child=k,t.nthChild=L,t.sibling=A,t.setNode=O,t.modifyNode=M,t.setEdge=_,t.modifyEdge=D,t.insertLeft=P,t.insertRight=H,t.insertChild=B,t.appendChild=j,t.treeZipper=F}),define("khepri-ast-zipper",["require","exports","nu-stream/gen","nu-stream/stream","neith/tree","khepri-ast/node"],function(e,t,n,r,i,s){var o=n.range,u=r.foldl,a=r.from,f=r.NIL,l=i.treeZipper,c=s.Node,h=s.modify,p,d=function(e){return u(function(e,t){var n=t.key,r=t.value;return e[n]=r,e},[],e)};p=l.bind(null,function(e){return e?Array.isArray(e)?o(0,e.length):a(e.children):f},function(e,t){return e[t]},function(e,t,n){return e instanceof c?h(e,n(),{}):d(t)}),t.khepriZipper=p}),define("bes/object",["require","exports"],function(e,t){var n,r,i,s=function(e){var t=Object.getOwnPropertyNames(e),n=t.length,r={};for(var i=0;i<n;i+=1){var s=t[i];r[s]=Object.getOwnPropertyDescriptor(e,s)}return r};n=function(e,t,n,r){var i=s(e),o=i[t];return i[t]={value:n,enumerable:!o||r!==undefined?r:o.enumerable},Object.create(Object.getPrototypeOf(e),i)},r=function(e,t){var n=s(e),r=Object.keys(e);for(var i=0,o=r.length;i<o;i+=1){var u=r[i],a=n[u],f=t[u].value,l=t[u].enumerable;n[u]={value:f,enumerable:!a||l!==undefined?l:a.enumerable}}return Object.create(Object.getPrototypeOf(e),n)},i=function(e,t){var n=s(e);return delete n[t],Object.create(Object.getPrototypeOf(e),n)},t.setProperty=n,t.setProperties=r,t.deleteProperty=i}),define("bes/record",["require","exports","./object"],function(e,t,n){var r=n.setProperty,i,s,o=Function.prototype.call.bind(Array.prototype.concat),u=Function.prototype.call.bind(Array.prototype.map),a=function(e){return e.match(/\w\S*/g).map(function(e){var t=e[0];return t.toUpperCase()+e.slice(1)}).join("")},f=function(e){return function(){var t=this,n=arguments;return e.apply(t,n)}},l=function(e){var t=e.length;return function(){var n=this,r=arguments;for(var i=0;i<t;i+=1)n[e[i]]=r[i]}},c=function(e){return function(t){var n=this;return r(n,e,t)}},h=function(e){return Function.prototype.call.bind(c(e))};i=function(e,t,n){var r=n||l(t);r.__keys=t,r.prototype=Object.create(e||new Object),r.prototype.constructor=r,t.forEach(function(e){var t="set"+a(e+"");r[t]=h(e),r.prototype[t]=c(e)});var i=function(e){var t=this;return r.apply(t,e)};return i.prototype=r.prototype,r.create=function(){var e=arguments;return new i(e)},r},s=function(e,t,n){return t&&t.length?i(new e,o(e.__keys,t),n):i(new e,e.__keys,n||f(e))},t.declare=i,t.extend=s}),define("khepri/compile/scope",["require","exports"],function(e,t){var n,r=function(e){return Object.keys(e).reduce(function(t,n){return t[n]=e[n],t},new e.constructor)},i=function(e,t,n){return Object.defineProperty(r(e),t,n)};n=function(e,t,n){var r=this;r.record=e,r.outer=t,r.mapping=n},n.prototype.hasOwnBinding=function(e){var t=this;return Object.prototype.hasOwnProperty.call(t.record,e)},n.prototype.hasBinding=function(e){var t=this;return t.hasOwnBinding(e)||t.outer&&t.outer.hasBinding(e)},n.prototype.getBinding=function(e){var t=this;return t.hasOwnBinding(e)?t.record[e]:t.outer?t.outer.getBinding(e):null},n.prototype.hasOwnMapping=function(e){var t=this;return Object.prototype.hasOwnProperty.call(t.mapping,e)},n.prototype.hasMapping=function(e){var t=this;return t.hasOwnMapping(e)||t.outer&&t.outer.hasMapping(e)},n.prototype.getMapping=function(e){var t=this;return t.hasOwnMapping(e)?t.mapping[e]:t.outer&&t.outer.getMapping(e)},n.prototype.getUnusedId=function(e){var t=this;if(!t.hasBinding(e))return e;for(var n=0;;n+=1)if(!t.hasBinding(e+n))return e+n},n.addBinding=function(e,t,r){return new n(i(e.record,t,{value:r,enumerable:!0,writable:!0,configurable:!0}),e.outer,e.mapping)},n.addMutableBinding=function(e,t,r){return n.addBinding(e,t,{mutable:!0,loc:r})},n.addImmutableBinding=function(e,t,r){return n.addBinding(e,t,{mutable:!1,loc:r})},n.addReservedBinding=function(e,t,r){return n.addBinding(e,t,{mutable:!1,reserved:!0,loc:r})},n.addMapping=function(e,t,r){return new n(e.record,e.outer,i(e.mapping,t,{value:r,enumerable:!0,writable:!0,configurable:!0}))},t.Scope=n}),define("khepri/compile/lexical",["require","exports","khepri-ast/node","khepri-ast/pattern","khepri-ast/value","neith/zipper","neith/tree","khepri-ast-zipper","bes/record","bes/object","./scope"],function(e,t,n,r,i,s,o,u,a,f,l){var c=n.setUserData,h=u.khepriZipper,p=l.Scope,d,v,m=Function.prototype.call.bind(Array.prototype.map),g=Function.prototype.call.bind(Array.prototype.reduce),y=Function.prototype.call.bind(Array.prototype.reduceRight),b=function(e,t){var n=[e,t];return n._next=!0,n},w=function(e){var t=e;while(t&&t._next)t=t[0].apply(undefined,t[1]);return t},E=a.declare(null,["ctx","realScope","scope","vars","unique"]);E.addVar=function(e,t,n){return e.setVars(f.setProperty(e.vars,t,n,!0))};var S=function(e){return function(t,n,r){return n(e,t)}},x=function(e){return function(t,n,r){return r(e,t)}},T=function(e,t){return function(n,r,i){return b(e,[n,function(e,n){return t(e)(n,r,i)},i])}},N=function(e,t){return T(e,function(e){return t})},C=function(e){return y(e,function(e,t){return N(t,e)},S())},k=function(){var e=arguments;return C(e)},L=function(e,t,n){return t(e,e)},A=function(e){return function(t,n,r){return n(e,e)}},O=function(e){return T(L,function(t){return A(e(t))})},M=function(e){return T(L,function(t){return e(t)})},_=function(e){return O(function(t){var n=e(t.ctx);return E.setCtx(t,n)})},D=function(e){return T(L,function(t){return e(t.scope)})},P=function(e){return T(L,function(t){return e(t.realScope)})},H=function(e){return function(t,n,r){var i=e(t.scope),s=E.setScope(t,i);return n(i,s)}},B=function(e){return function(t,n,r){var i=e(t.realScope),s=E.setRealScope(t,i);return n(i,s)}},j=function(e){return H(function(){return e})},F=function(e){return B(function(){return e})},I=S(),q=function(e){return T(M(function(e){return S(e.unique)}),function(e){return k(O(function(t){return t.setUnique(e+1)}),S(e))})},R=function(){var e=arguments;return D(function(t){return k(j(new p({},t,t.mapping)),C(e),j(t))})},U=function(){var e=arguments;return D(function(t){return k(j(new p({},t,{})),C(e),j(t))})},z=function(){var e=arguments;return P(function(t){return k(F(new p({},t,{})),U.apply(undefined,e),F(t))})},W=function(e,t){return D(function(n){return n.hasOwnBinding(e)?function(){var r=t&&t.start,i=n.getBinding(e),s=i.loc&&i.loc.start;return x("'"+e+"' at:"+r+" already bound for scope from:"+s)}():I})},X=function(e,t){return D(function(n){return n.hasBinding(e)?I:x("Undeclared identifier:'"+e+"' at:"+t)})},V=function(e,t){return k(X(e,t),D(function(n){var r=n.getBinding(e);return r.reserved?x("Undeclared identifier:'"+e+"' at:"+t):I}))},$=function(e,t){return D(function(n){return n.hasBinding(e)?function(){var r=n.getBinding(e);return r.mutable?I:x("Assign to immutable variable:'"+e+"' at:"+t)}():I})},J=function(e,t){return P(function(t){return S(t.hasOwnBinding(e)?t.getUnusedId(e):e)})},K=function(e,t){return H(function(n){return p.addMapping(n,e,t)})},Q=function(e,t){return k(H(function(n){return p.addMutableBinding(n,e,t)}),B(function(n){return p.addMutableBinding(n,e,t)}),K(e,e))},G=function(e,t){return k(H(function(n){return p.addImmutableBinding(n,e,t)}),B(function(n){return p.addImmutableBinding(n,e,t)}),K(e,e))},Y=function(e,t){return k(W(e,t),P(function(n){return n.hasOwnBinding(e)?function(){var r=n.getUnusedId(e);return k(Q(e,t),Q(r,t),K(e,r))}():Q(e,t)}))},Z=function(e,t){return k(W(e,t),Y(e,t))},et=function(e,t){return k(W(e,t),G(e,t))},tt=function(e,t){return P(function(n){return n.hasOwnBinding(e)?function(){var r=n.getUnusedId(e);return k(G(e,t),G(r,t),K(e,r))}():et(e,t)})},nt=function(e,t){return k(W(e,t),tt(e,t))},rt=function(e,t){return k(H(function(n){return p.addReservedBinding(n,e,t)}),B(function(n){return p.addReservedBinding(n,e,t)}),K(e,e))},it,st=function(e,t){return k(_(o.child.bind(null,t)),e,_(s.up))},ot=function(e){return it(o.node(e))},ut=function(e,t,n){return ot(e.ctx)(e,t,n)},at=st.bind(null,ut),ft=function(e){return _(o.modifyNode.bind(null,e))},lt=function(e){return _(o.setNode.bind(null,e))};it=function(e){if(Array.isArray(e))return e.length?k(_(s.down),C(m(e,function(t,n){return n===e.length-1?ut:N(ut,_(s.right))})),_(s.up)):I;if(e instanceof n.Node){switch(e.type){case"Program":return at("body");case"Package":return k(et("require",null),et("exports",null),et("module",null),at("exports"),e.body.type==="WithStatement"?st(k(at("bindings"),st(at("body"),"body")),"body"):st(at("body"),"body"));case"PackageExports":return at("exports");case"PackageExport":return Z(e.id.name,e.loc);case"CatchClause":return R(et(e.param.name,e.param.loc),st(at("body"),"body"));case"SwitchCase":return k(at("test"),at("consequent"));case"StaticDeclaration":case"VariableDeclaration":return at("declarations");case"StaticDeclarator":return et(e.id.name,e.loc);case"VariableDeclarator":return k(Z(e.id.name,e.loc),at("id"),at("init"));case"Binding":return k(at("pattern"),at("value"));case"BlockStatement":return R(at("body"));case"ExpressionStatement":return at("expression");case"IfStatement":return k(at("test"),R(at("consequent")),R(at("alternate")));case"WithStatement":return R(at("bindings"),st(at("body"),"body"));case"SwitchStatement":return R(at("discriminant"),at("cases"));case"ReturnStatement":case"ThrowStatement":return at("argument");case"TryStatement":return k(at("block"),R(at("handler")),R(at("finalizer")));case"WhileStatement":return k(at("test"),R(at("body")));case"DoWhileStatement":return k(R(at("body")),at("test"));case"ForStatement":return R(at("init"),at("test"),at("update"),R(at("body")));case"UnaryExpression":return at("argument");case"AssignmentExpression":return k(at("left"),e.left.type==="Identifier"?$(e.left.name,e.left.loc.start):I,at("right"));case"LogicalExpression":case"BinaryExpression":return k(at("left"),at("right"));case"ConditionalExpression":return k(at("test"),at("consequent"),at("alternate"));case"CallExpression":case"NewExpression":return k(at("callee"),at("args"));case"MemberExpression":return k(at("object"),e.computed?at("property"):I);case"ArrayExpression":return at("elements");case"ObjectExpression":return at("properties");case"LetExpression":return R(at("bindings"),at("body"));case"CurryExpression":return k(at("base"),at("args"));case"UnaryOperatorExpression":case"BinaryOperatorExpression":case"TernaryOperatorExpression":return I;case"FunctionExpression":return z(e.id?G(e.id.name,e.loc):I,at("params"),st(at("body"),"body"));case"EllipsisPattern":return I;case"SinkPattern":return T(J("_"),function(t){return k(ft(function(e){var n=c(e,e.ud||{}),r=i.Identifier.create(null,t);return n.ud.id=r,n}),rt(t,e.loc))});case"IdentifierPattern":if(e.reserved)return rt(e.id.name,e.loc);return k(nt(e.id.name,e.loc),at("id"),ft(function(e){var t=c(e,e.ud||{});return t.ud.id=i.Identifier.create(null,e.id.name),t}));case"ImportPattern":return at("pattern");case"AsPattern":return k(at("id"),st(k(ft(function(t){var n=c(t,t.ud||{});return n.ud.id=e.id,n}),ut),"target"));case"ArrayPattern":case"ObjectPattern":return D(function(t){if(!e.ud||!e.ud.id){var n=t.getUnusedId("__o"),s=r.IdentifierPattern.create(e.loc,i.Identifier.create(null,n));s.reserved=!0;var o=c(e,e.ud||{});return o.ud.id=s,k(lt(r.AsPattern.create(null,s,e)),ut)}return at("elements")});case"ObjectPatternElement":return k(at("target"),at("key"));case"ArgumentsPattern":return k(at("id"),at("elements"),at("self"));case"ObjectValue":return at("value");case"Identifier":var t=e.name;return D(function(r){return r.hasMapping(t)?function(){var i=r.getMapping(t);return k(ft(function(e){return n.modify(e,{},{name:i})}),V(i,e.loc))}():V(t,e.loc)})}return I}return I};var ct=["Array","Boolean","Date","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","Error","eval","EvalError","Function","Infinity","isFinite","isNaN","JSON","Math","NaN","Number","Object","parseInt","parseFloat","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","undefined","URIError"],ht=function(e,t){var n=g(t,p.addImmutableBinding,new p({},null,{})),r=new E(h(e),n,n);return w(ut(r,function(e,t){return o.node(s.root(t.ctx))},function(e,t){throw e}))};d=function(e,t){return ht(e,t||ct)},v=function(e){var t=e.options,n=e.ast;return{ast:d(n,t&&t.globals||ct),options:t}},t.check=d,t.checkStage=v}),define("khepri/compile/khepri_peep",["require","exports","neith/tree","neith/zipper","khepri-ast-zipper","khepri-ast/node","khepri-ast/statement","khepri-ast/expression","khepri-ast/pattern","khepri-ast/value"],function(e,t,n,r,i,s,o,u,a,f){var l=i.khepriZipper,c=s.modify,h=s.Node,p=s.setUserData,d,v=function(){var e=arguments;return[].concat.apply([],e)},m=function(e,t){return[].map.call(t,e)},g=Function.prototype.call.bind(Array.prototype.reduce),y=function(e){return Array.isArray(e)?g(e,function(e,t){return e.concat(t)},[]):e},b={},w=function(e,t,n){var r={condition:t,map:n};b[e]=b[e]?b[e].concat(r):[r]};w("ReturnStatement",function(e){return e.argument&&e.argument.type==="LetExpression"},function(e){return o.WithStatement.create(null,e.argument.bindings,o.BlockStatement.create(null,[o.ReturnStatement.create(e.loc,e.argument.body)]))}),w("ExpressionStatement",function(e){return e.expression&&e.expression.type==="LetExpression"},function(e){return o.WithStatement.create(null,e.expression.bindings,o.BlockStatement.create(null,[o.ExpressionStatement.create(e.loc,e.expression.body)]))}),w("ExpressionStatement",function(e){return e.expression&&e.expression.type==="AssignmentExpression"&&e.expression.right.type==="LetExpression"},function(e){return o.WithStatement.create(null,e.expression.right.bindings,o.BlockStatement.create(null,[o.ExpressionStatement.create(e.loc,u.AssignmentExpression.create(e.expression.loc,e.expression.operator,e.expression.left,e.expression.right.body))]))}),w("ArrayPattern",function(e){return!0},function(e){var t=e.loc,n=e.elements,r=e.ud;return p(a.ObjectPattern.create(t,m(function(e,t){return a.ObjectPatternElement.create(null,f.Literal.create(null,"number",t),e)},n)),r)}),w("ObjectPatternElement",function(e){return!e.target},function(e){var t=e.loc,n=e.key;switch(n.type){case"IdentifierPattern":return a.ObjectPatternElement.create(null,f.Literal.create(null,"string",n.id.name),n);case"AsPattern":return a.ObjectPatternElement.create(null,f.Literal.create(null,"string",n.id.id.name),n);default:return e}}),w("CurryExpression",function(e){return!e.args.length},function(e){return e.base}),w("CurryExpression",function(e){return e.base.type==="CurryExpression"},function(e){return u.CurryExpression.create(null,e.base.base,v(e.base.args,e.args))}),w("BinaryExpression",function(e){return e.operator==="|>"&&(e.right.type==="CurryExpression"||e.right.type==="BinaryOperatorExpression"||e.right.type==="UnaryOperatorExpression"||e.right.type==="TernaryOperatorExpression")},function(e){return u.CallExpression.create(null,e.right.type==="CurryExpression"?e.right.base:e.right,v(e.right.args||[],e.left))}),w("BinaryExpression",function(e){var t=e.operator,n=e.left;return t==="<|"&&(n.type==="CurryExpression"||n.type==="BinaryOperatorExpression"||n.type==="UnaryOperatorExpression"||n.type==="TernaryOperatorExpression")},function(e){return u.CallExpression.create(null,e.left.type==="CurryExpression"?e.left.base:e.left,v(e.left.args||[],e.right))});var E=function(e){var t=n.modifyNode(function(e){if(!e)return e;var t=(b[e.type]||[]).filter(function(t){return t.condition(e)});return t.reduce(function(e,t){return t.map(e)},e)},e),i=r.nextDfs(t);return i?E(i):t};d=function(e){var t=e.options,i=e.ast;return{options:t,ast:n.node(r.root(E(l(i))))}},t.optimize=d}),define("ecma-ast-zipper",["require","exports","nu-stream/gen","nu-stream/stream","neith/tree","ecma-ast/node"],function(e,t,n,r,i,s){var o=n.range,u=r.foldl,a=r.from,f=r.NIL,l=i.treeZipper,c=s.Node,h=s.modify,p,d=function(e){return u(function(e,t){var n=t.key,r=t.value;return e[n]=r,e},[],e)};p=l.bind(null,function(e){return e?Array.isArray(e)?o(0,e.length):a(e.children):f},function(e,t){return e[t]},function(e,t,n){return e instanceof c?h(e,n(),{}):d(t)}),t.ecmaZipper=p}),define("khepri/compile/ecma_peep",["require","exports","neith/tree","neith/zipper","ecma-ast-zipper","ecma-ast/node","ecma-ast/value","ecma-ast/declaration","ecma-ast/statement","ecma-ast/expression"],function(e,t,n,r,i,s,o,u,a,f){var l=i.ecmaZipper,c=s.modify,h=s.Node,p,d=function(){var e=arguments;return[].concat.apply([],e)},v=function(e,t){return[].map.call(t,e)},m=Function.prototype.call.bind(Array.prototype.reduce),g=function(e){return Array.isArray(e)?[].concat.apply([],e.map(g)):e},y={},b=function(e,t,n,r){var i={condition:n,map:r,up:t};e.forEach(function(e){y[e]=y[e]?y[e].concat(i):[i]})};b(["VariableDeclaration"],!1,function(e){return!0},function(e){var t=e.declarations.filter(function(e){return!!e});return c(e,{declarations:t},{})}),b(["VariableDeclaration"],!0,function(e){return!e.declarations.length},function(e){return null}),b(["Program","BlockStatement"],!0,function(e){return!0},function(e){return c(e,{body:g(e.body.map(function(e){return e&&e.type==="BlockStatement"?e.body:e}))},{})}),b(["Program","BlockStatement"],!0,function(e){return!0},function(e){return c(e,{body:e.body.reduceRight(function(e,t){return t&&t.type==="VariableDeclaration"&&e.length&&e[0].type==="VariableDeclaration"?d(c(t,{declarations:d(t.declarations,e[0].declarations)},{}),e.slice(1)):d(t,e)},[])},{})}),b(["Program","BlockStatement"],!0,function(e){return!0},function(e){return c(e,{body:g(e.body.map(function(e){return!e||e.type==="EmptyStatement"?[]:e}))},{})});var w={"+":function(e,t){return e+t},"-":function(e,t){return e-t},"*":function(e,t){return e*t},"/":function(e,t){return e/t},"%":"%","<<":function(e,t){return e<<t},">>":function(e,t){return e>>t},">>>":function(e,t){return e>>>t},"<":function(e,t){return e<t},">":function(e,t){return e>t},"<=":function(e,t){return e<=t},">=":function(e,t){return e>=t},"||":function(e,t){return e||t},"&&":function(e,t){return e&&t}},E=function(e){return e.type==="Literal"&&(e.kind==="string"||e.kind==="number"||e.kind==="boolean"||e.kind==="null")};b(["BinaryExpression","LogicalExpression"],!0,function(e){var t=e.operator,n=e.left,r=e.right;return w[t]&&E(n)&&E(r)},function(e){var t=e.operator,n=e.left,r=e.right,i=w[t](n.value,r.value);return o.Literal.create(null,typeof i,i)});var S={"!":function(e){return!e},"~":function(e){return~e},"typeof":function(e){return typeof e},"+":function(e){return+e},"-":function(e){return-e}},x=function(e){return e.type==="Literal"&&(e.kind==="string"||e.kind==="number"||e.kind==="boolean"||e.kind==="null")};b(["UnaryExpression"],!0,function(e){var t=e.operator,n=e.argument;return S[t]&&x(n)},function(e){var t=e.operator,n=e.argument,r=S[t](n.value);return o.Literal.create(null,typeof r,r)});var T=function(e){var t=(y[e.type]||[]).filter(function(t){return t.condition(e)}),n=t.filter(function(e){return!e.up}),r=t.filter(function(e){return e.up});return n.reduce(function(e,t){return t.map(e,T)},e)},N=function(e){var t=(y[e.type]||[]).filter(function(t){return!t.up&&t.condition(e)});return t.reduce(function(e,t){return t.map(e,N)},e)},C=function(e){var t=(y[e.type]||[]).filter(function(t){return t.up&&t.condition(e)});return t.reduce(function(e,t){return t.map(e,C)},e)},k=function(e){var t=n.modifyNode(function(e){return e&&N(e)},e);if(r.isLeaf(t))do{t=n.modifyNode(function(e){return e&&C(e)},t);if(!r.isLast(t))return k(r.right(t));if(r.isRoot(t))return t;t=r.up(t)}while(!0);return k(r.down(t))};p=function(e){var t=e.options,i=e.ast;return{options:t,ast:n.node(r.root(k(l(i))))}},t.optimize=p}),define("khepri/compile/compile",["require","exports","./lexical","./transform","./khepri_peep","./ecma_peep"],function(e,t,n,r,i,s){var o;o=function(e,t){return function(){return e(t.apply(null,arguments))}}(function(e){var t=e.ast;return t},function(e,t){return function(){return e(t.apply(null,arguments))}}(s.optimize,function(e,t){return function(){return e(t.apply(null,arguments))}}(r.transform,function(e,t){return function(){return e(t.apply(null,arguments))}}(i.optimize,function(e,t){return function(){return e(t.apply(null,arguments))}}(n.checkStage,function(e,t){return{ast:e,options:t||{}}}))))),t.compile=o}),define("ecma-ast/token",["require","exports","./node"],function(e,t,n){var r=n.Node,i=n.defineNode,s,o,u,a,f,l,c,h,p,d,v,m;s=function(e,t){var n=this;r.call(n,e),n.value=t},s.prototype=new r,o=i(s,"String",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),u=i(s,"Number",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),a=i(s,"RegularExpression",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),f=i(s,"Boolean",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),l=i(s,"Null",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),c=i(s,"Identifier",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),h=i(s,"Keyword",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),p=i(s,"Punctuator",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),d=i(s,"Comment",[],["value","multiline","linebreak"],function(e,t,n,r){var i=this;s.call(i,e,t),i.multiline=!!n,i.linebreak=!!r}),v=i(s,"Whitespace",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),m=i(s,"LineTerminator",[],["value"],function(e,t){var n=this;s.call(n,e,t)}),t.Token=s,t.StringToken=o,t.NumberToken=u,t.RegularExpressionToken=a,t.BooleanToken=f,t.NullToken=l,t.IdentifierToken=c,t.KeywordToken=h,t.PunctuatorToken=p,t.CommentToken=d,t.WhitespaceToken=v,t.LineTerminatorToken=m}),define("ecma-unparse/unparse",["require","exports","nu-stream/stream","nu-stream/gen","ecma-ast/token","ecma-ast/node"],function(e,t,n,r,i,s){var o,u=Array.prototype.slice,a=function(e,t){return e.length===0?n.end:e.length===1?e[0]:n.append(e[0],n.cons(t,a(e.slice(1),t)))},f=function(e,t){return e.length===0?n.end:e.length===1?e[0]:n.append(e[0],n.append(t,f(e.slice(1),t)))},l=function(e){return new i.KeywordToken(null,e)},c=function(e){return new i.LineTerminatorToken(null,e||"\n")},h=function(e){return new i.PunctuatorToken(null,e)},p=function(e){return new i.WhitespaceToken(null,e||" ")},d=function(){var e=arguments;if(e.length===0)return n.end;var t=e[0],r=d.apply(undefined,u.call(e,1));return t===undefined||n.isEmpty(t)?r:n.isStream(t)?n.append(t,r):n.cons(t,r)},v=function(){var e=arguments;return d(d.apply(undefined,e),c())},m=function(){var e=arguments;return d.apply(undefined,e)},g=function(){var e=arguments;return d.apply(undefined,e)},y=function(){var e=arguments;return d(d.apply(undefined,e),c())},b=function(){var e=arguments;return d.apply(undefined,e)},w=function(e){return b(new i.IdentifierToken(null,e))},E=function(e){return b(new i.StringToken(null,e))},S=function(e){return b(new i.NumberToken(null,e))},x=function(e){return b(new i.NullToken(null,e))},T=function(e){return b(new i.BooleanToken(null,e))},N=function(e){return b(new i.RegularExpressionToken(null,e))},C=function(e){return d.apply(undefined,e)},k=function(e){return v(l("var"),p(),a(e,h(",")),h(";"))},L=function(e,t){return g(e,t?d(p(),h("="),p(),t):n.end)},A=function(e,t,r){return m(h("("),l("function"),e?d(p(),e):n.end,h("("),f(t,d(h(","),p())),h(")"),p(),r,h(")"))},O=function(e,t,n){return g(l("function"),p(),h("("),f(t,d(h(","),p())),h(")"),p(),n)},M=function(e,t){return d(e?d(l("case"),p(),e):l("default"),h(":"),c(),d.apply(undefined,t))},_=function(e,t){return d(l("catch"),h("("),e,h(")"),t)},D=function(){return v(h(";"))},P=function(){return v(l("debugger"),h(";"))},H=function(e){return v(h("{"),c(),d.apply(undefined,e),h("}"))},B=function(e){return v(e,h(";"))},j=function(e,t,r){return v(l("if"),p(),h("("),e,h(")"),t,r?d(l("else"),p(),r):n.end)},F=function(e,t){return v(w(e),h(":"),t)},I=function(e){return v(l("break"),p(),e,h(";"))},q=function(e){return v(l("continue"),p(),e,h(";"))},R=function(e,t){return v(l("with"),h("("),e,h(")"),h("{"),t,h("}"))},U=function(e,t){return v(l("switch"),h("("),e,h(")"),h("{"),c(),d.apply(undefined,t),h("}"))},z=function(e){return v(l("return"),p(),e,h(";"))},W=function(e){return v(l("throw"),p(),e,h(";"))},X=function(e,t,r){return v(l("try"),e,t?t:n.end,r?d(l("finally"),r):n.end)},V=function(e,t){return v(l("while"),h("("),e,h(")"),t)},$=function(e,t){return v(l("do"),e,l("while"),h("("),t,h(")"),h(";"))},J=function(e,t,n,r){return v(l("for"),h("("),e,p(),t,h(";"),n,h(")"),r)},K=function(e,t,n,r){return v(l("for"),h("("),e,h(";"),t,h(";"),n,h(")"),r)},Q=function(e,t){return v(l("for"),h("("),s.left,h("in"),s.right,h(")"),s.body)},G=function(){return m(l("this"))},Y=function(e){return m(a(e,h(",")))},Z=function(e,t){return m(h("("),e,p(),t,h(")"))},et=function(e,t,n){return m(h("("),t,p(),e,p(),n,h(")"))},tt=function(e,t,n){return n?m(e,t):m(t,e)},nt=function(e,t,n){return m(h("("),e,p(),h("?"),p(),t,p(),h(":"),p(),n,h(")"))},rt=function(e,t){return m(l("new"),p(),h("("),e,h(")"),t?d(h("("),f(t,d(h(","),p())),h(")")):n.end)},it=function(e,t){return m(e,h("("),f(t,d(h(","),p())),h(")"))},st=function(e,t,n){return n?m(e,h("["),t,h("]")):m(e,h("."),t)},ot=function(e){return m(h("["),f(e,d(h(","),p())),h("]"))},ut=function(e){return m(h("("),h("{"),e&&e.length?d(c(),f(e,d(h(","),c())),c()):n.end,h("}"),h(")"))},at=function(e,t){return d(w("get"),p(),e,h("("),h(")"),p(),t)},ft=function(e,t,n){return d(w("set"),p(),e,h("("),d.apply(undefined,t),h(")"),p(),n)},lt=function(e,t){return d(e,h(":"),p(),t)},ct=function(e){if(!e)return n.end;switch(e.type){case"SwitchCase":return M(e.test?ct(e.test):null,e.consequent.map(ct));case"CatchClause":return _(ct(e.param),ct(e.body));case"EmptyStatement":return D();case"DebuggerStatement":return P();case"BlockStatement":return H(e.body.map(ct));case"ExpressionStatement":return B(ct(e.expression));case"IfStatement":return j(ct(e.test),ct(e.consequent),e.alternate?ct(e.alternate):null);case"LabeledStatement":return F(ct(e.label),ct(e.body));case"BreakStatement":return I(ct(e.label));case"ContinueStatement":return q(ct(e.label));case"WithStatement":return R(ct(e.object),ct(e.body));case"SwitchStatement":return U(ct(e.discriminant),e.cases.map(ct));case"ReturnStatement":return z(ct(e.argument));case"ThrowStatement":return W(ct(e.argument));case"TryStatement":return X(ct(e.block),e.handler?ct(e.handler):null,e.finalizer?ct(e.finalizer):null);case"WhileStatement":return V(ct(e.test),ct(e.body));case"DoWhileStatement":return $(ct(e.body),ct(e.test));case"ForStatement":var t=e.init?ct(e.init):null,r=e.test?ct(e.test):null,i=e.update?ct(e.update):null,s=ct(e.body);return e.init&&e.init.type==="VariableDeclaration"?J(t,r,i,s):K(t,r,i,s);case"ForInStatement":return Q(ct(e.left),ct(e.right),ct(e.body));case"ThisExpression":return G();case"SequenceExpression":return Y(e.expressions.map(ct));case"UnaryExpression":return Z(h(e.operator),ct(e.argument));case"BinaryExpression":case"LogicalExpression":case"AssignmentExpression":return et(h(e.operator),ct(e.left),ct(e.right));case"UpdateExpression":return tt(h(e.operator),ct(e.argument),e.prefix);case"ConditionalExpression":return nt(ct(e.test),ct(e.consequent),ct(e.alternate));case"NewExpression":return rt(ct(e.callee),e.args?e.args.map(ct):null);case"CallExpression":return it(ct(e.callee),e.args.map(ct));case"MemberExpression":return st(ct(e.object),ct(e.property),e.computed);case"ArrayExpression":return ot(e.elements.map(ct));case"ObjectExpression":return ut(e.properties.map(ct));case"ObjectValue":return lt(ct(e.key),ct(e.value));case"ObjectGetter":return at(ct(e.key),ct(e.value.body));case"ObjectSetter":return ft(ct(e.key),e.value.params.map(ct),ct(e.value.body));case"FunctionExpression":return A(e.id?ct(e.id):null,e.params.map(ct),ct(e.body));case"FunctionDeclaration":return O(ct(e.id),e.params.map(ct),ct(e.body));case"Program":return C(e.body.map(ct));case"VariableDeclaration":return k(e.declarations.map(ct));case"VariableDeclarator":return L(ct(e.id),e.init?ct(e.init):null);case"Identifier":return w(e.name);case"Literal":switch(e.kind){case"string":return E(e.value);case"number":return S(e.value);case"null":return x(e.value);case"boolean":return T(e.value);case"regexp":return N(e.value);default:return n.end};default:return n.end}};o=ct,t.unparse=o}),function(){function e(e,n){var r=new t(e,n);return r.beautify()}function t(e,t){function A(e,t){var n=0;e&&(n=e.indentation_level,n+=e.var_line&&e.var_line_reindented?1:0,!H()&&e.line_indent_level>n&&(n=e.line_indent_level));var i={mode:t,parent:e,last_text:e?e.last_text:"",last_word:e?e.last_word:"",var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,multiline_frame:!1,if_block:!1,do_block:!1,do_while:!1,in_case_statement:!1,in_case:!1,case_body:!1,indentation_level:n,line_indent_level:e?e.line_indent_level:n,start_line_index:r.length,ternary_depth:0};return i}function O(){return{text:[]}}function M(e){e=e===undefined?!1:e;if(r.length){_(r[r.length-1],e);while(e&&r.length>1&&r[r.length-1].text.length===0)r.pop(),_(r[r.length-1],e)}}function _(e){while(e.text.length&&(e.text[e.text.length-1]===" "||e.text[e.text.length-1]===a||e.text[e.text.length-1]===L))e.text.pop()}function D(e){return e.replace(/^\s+|\s+$/g,"")}function P(e){e=e.replace(/\x0d/g,"");var t=[],n=e.indexOf("\n");while(n!==-1)t.push(e.substring(0,n)),e=e.substring(n+1),n=e.indexOf("\n");return e.length&&t.push(e),t}function H(){var e=r[r.length-1];return e.text.length===0}function B(){if(H()){if(r.length===1)return!0;var e=r[r.length-2];return e.text.length===0}return!1}function j(e){e=e===undefined?!1:e;if(k.wrap_line_length&&!e){var t=r[r.length-1],n=0;t.text.length>0&&(n=t.text.join("").length+i.length+(E?1:0),n>=k.wrap_line_length&&(e=!0))}(k.preserve_newlines&&b||e)&&!H()&&(F(!1,!0),!$(f.mode)&&!J(f.mode)&&(w=!0))}function F(e,t){w=!1,E=!1;if(!t&&f.last_text!==";")while(f.mode===C.Statement&&!f.if_block&&!f.do_block)K();if(r.length===1&&H())return;if(e||!H())f.multiline_frame=!0,r.push(O())}function I(){if(H()){var e=r[r.length-1];if(k.keep_array_indentation&&$(f.mode)&&b){e.text.push("");for(var t=0;t<T.length;t+=1)e.text.push(T[t])}else L&&e.text.push(L),q(f.indentation_level+(f.var_line&&f.var_line_reindented?1:0)+(w?1:0))}}function q(e){if(r.length>1){var t=r[r.length-1];f.line_indent_level=e;for(var n=0;n<e;n+=1)t.text.push(a)}}function R(){var e=r[r.length-1];if(E&&e.text.length){var t=e.text[e.text.length-1];t!==" "&&t!==a&&e.text.push(" ")}}function U(e){e=e||i,I(),w=!1,R(),E=!1,r[r.length-1].text.push(e)}function z(){f.indentation_level+=1}function W(){f.indentation_level>0&&(!f.parent||f.indentation_level>f.parent.indentation_level)&&(f.indentation_level-=1)}function X(e){if(e.multiline_frame)return;var t=e.start_line_index,n=0,i;while(t<r.length){i=r[t],t++;if(i.text.length===0)continue;L&&i.text[0]===L?n=1:n=0,i.text[n]===a&&i.text.splice(n,1)}}function V(e){f?(c.push(f),l=f):l=A(null,e),f=A(l,e)}function $(e){return e===C.ArrayLiteral}function J(e){return et(e,[C.Expression,C.ForInitializer,C.Conditional])}function K(){c.length>0&&(l=f,f=c.pop())}function Q(){return f.mode===C.ObjectLiteral&&f.last_text===":"&&f.ternary_depth===0}function G(){return f.last_text==="do"||f.last_text==="else"&&i!=="if"||o==="TK_END_EXPR"&&(l.mode===C.ForInitializer||l.mode===C.Conditional)?(j(et(i,["do","for","if","while"])),V(C.Statement),H()&&(z(),w=!1),!0):!1}function Y(e,t){for(var n=0;n<e.length;n++){var r=D(e[n]);if(r.charAt(0)!==t)return!1}return!0}function Z(e){return et(e,["case","return","do","if","throw","else"])}function et(e,t){for(var n=0;n<t.length;n+=1)if(t[n]===e)return!0;return!1}function tt(e){var t=!1,n="",r=0,i="",s=0,o;while(t||r<e.length){o=e.charAt(r),r++;if(t){t=!1;if(o==="x")i=e.substr(r,2),r+=2;else{if(o!=="u"){n+="\\"+o;continue}i=e.substr(r,4),r+=4}if(!i.match(/^[0123456789abcdefABCDEF]+$/))return e;s=parseInt(i,16);if(s>=0&&s<32){o==="x"?n+="\\x"+i:n+="\\u"+i;continue}if(s===34||s===39||s===92)n+="\\"+String.fromCharCode(s);else{if(o==="x"&&s>126&&s<=255)return e;n+=String.fromCharCode(s)}}else o==="\\"?t=!0:n+=o}return n}function nt(e){var t=v,r=n.charAt(t);while(et(r,h)&&r!==e){t++;if(t>=S)return!1;r=n.charAt(t)}return r===e}function rt(){var e,t;x=0;if(v>=S)return["","TK_EOF"];b=!1,T=[];var i=n.charAt(v);v+=1;while(et(i,h)){i==="\n"?(x+=1,T=[]):x&&(i===a?T.push(a):i!=="\r"&&T.push(" "));if(v>=S)return["","TK_EOF"];i=n.charAt(v),v+=1}if(et(i,p)){if(v<S)while(et(n.charAt(v),p)){i+=n.charAt(v),v+=1;if(v===S)break}if(v===S||!i.match(/^[0-9]+[Ee]$/)||n.charAt(v)!=="-"&&n.charAt(v)!=="+")return i==="in"?[i,"TK_OPERATOR"]:[i,"TK_WORD"];var s=n.charAt(v);v+=1;var u=rt();return i+=s+u[0],[i,"TK_WORD"]}if(i==="("||i==="[")return[i,"TK_START_EXPR"];if(i===")"||i==="]")return[i,"TK_END_EXPR"];if(i==="{")return[i,"TK_START_BLOCK"];if(i==="}")return[i,"TK_END_BLOCK"];if(i===";")return[i,"TK_SEMICOLON"];if(i==="/"){var c="",m=!0;if(n.charAt(v)==="*"){v+=1;if(v<S)while(v<S&&(n.charAt(v)!=="*"||!n.charAt(v+1)||n.charAt(v+1)!=="/")){i=n.charAt(v),c+=i;if(i==="\n"||i==="\r")m=!1;v+=1;if(v>=S)break}return v+=2,m&&x===0?["/*"+c+"*/","TK_INLINE_COMMENT"]:["/*"+c+"*/","TK_BLOCK_COMMENT"]}if(n.charAt(v)==="/"){c=i;while(n.charAt(v)!=="\r"&&n.charAt(v)!=="\n"){c+=n.charAt(v),v+=1;if(v>=S)break}return[c,"TK_COMMENT"]}}if(i==="'"||i==='"'||(i==="/"||k.e4x&&i==="<"&&n.slice(v-1).match(/^<([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*\/?\s*>/))&&(o==="TK_WORD"&&Z(f.last_text)||o==="TK_END_EXPR"&&et(l.mode,[C.Conditional,C.ForInitializer])||et(o,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var y=i,w=!1,E=!1;t=i;if(v<S)if(y==="/"){var N=!1;while(w||N||n.charAt(v)!==y){t+=n.charAt(v),w?w=!1:(w=n.charAt(v)==="\\",n.charAt(v)==="["?N=!0:n.charAt(v)==="]"&&(N=!1)),v+=1;if(v>=S)return[t,"TK_STRING"]}}else if(k.e4x&&y==="<"){var L=/<(\/?)([-a-zA-Z:0-9_.]+|{[^{}]*}|!\[CDATA\[[\s\S]*?\]\])\s*([-a-zA-Z:0-9_.]+=('[^']*'|"[^"]*"|{[^{}]*})\s*)*(\/?)\s*>/g,A=n.slice(v-1),O=L.exec(A);if(O&&O.index===0){var M=O[2],_=0;while(O){var P=!!O[1],H=O[2],B=!!O[O.length-1]||H.slice(0,8)==="![CDATA[";H===M&&!B&&(P?--_:++_);if(_<=0)break;O=L.exec(A)}var j=O?O.index+O[0].length:A.length;return v+=j-1,[A.slice(0,j),"TK_STRING"]}}else while(w||n.charAt(v)!==y){t+=n.charAt(v);if(w){if(n.charAt(v)==="x"||n.charAt(v)==="u")E=!0;w=!1}else w=n.charAt(v)==="\\";v+=1;if(v>=S)return[t,"TK_STRING"]}v+=1,t+=y,E&&k.unescape_strings&&(t=tt(t));if(y==="/")while(v<S&&et(n.charAt(v),p))t+=n.charAt(v),v+=1;return[t,"TK_STRING"]}if(i==="#"){if(r.length===1&&r[0].text.length===0&&n.charAt(v)==="!"){t=i;while(v<S&&i!=="\n")i=n.charAt(v),t+=i,v+=1;return[D(t)+"\n","TK_UNKNOWN"]}var F="#";if(v<S&&et(n.charAt(v),g)){do i=n.charAt(v),F+=i,v+=1;while(v<S&&i!=="#"&&i!=="=");return i!=="#"&&(n.charAt(v)==="["&&n.charAt(v+1)==="]"?(F+="[]",v+=2):n.charAt(v)==="{"&&n.charAt(v+1)==="}"&&(F+="{}",v+=2)),[F,"TK_WORD"]}}if(i==="<"&&n.substring(v-1,v+3)==="<!--"){v+=3,i="<!--";while(n.charAt(v)!=="\n"&&v<S)i+=n.charAt(v),v++;return f.in_html_comment=!0,[i,"TK_COMMENT"]}if(i==="-"&&f.in_html_comment&&n.substring(v-1,v+2)==="-->")return f.in_html_comment=!1,v+=2,["-->","TK_COMMENT"];if(i===".")return[i,"TK_DOT"];if(et(i,d)){while(v<S&&et(i+n.charAt(v),d)){i+=n.charAt(v),v+=1;if(v>=S)break}return i===","?[i,"TK_COMMA"]:i==="="?[i,"TK_EQUALS"]:[i,"TK_OPERATOR"]}return[i,"TK_UNKNOWN"]}function it(){G();var e=C.Expression;if(i==="["){if(o==="TK_WORD"||f.last_text===")"){et(f.last_text,m)&&(E=!0),V(e),U(),z(),k.space_in_paren&&(E=!0);return}e=C.ArrayLiteral,$(f.mode)&&(f.last_text==="["||f.last_text===","&&(u==="]"||u==="}"))&&(k.keep_array_indentation||F())}else f.last_text==="for"?e=C.ForInitializer:et(f.last_text,["if","while"])&&(e=C.Conditional);f.last_text===";"||o==="TK_START_BLOCK"?F():o==="TK_END_EXPR"||o==="TK_START_EXPR"||o==="TK_END_BLOCK"||f.last_text==="."?(j(b),w=!1):o!=="TK_WORD"&&o!=="TK_OPERATOR"?E=!0:f.last_word==="function"||f.last_word==="typeof"?k.jslint_happy&&(E=!0):(et(f.last_text,m)||f.last_text==="catch")&&k.space_before_conditional&&(E=!0),i==="("&&(o==="TK_EQUALS"||o==="TK_OPERATOR")&&(Q()||j()),V(e),U(),k.space_in_paren&&(E=!0),z()}function st(){while(f.mode===C.Statement)K();i==="]"&&$(f.mode)&&f.multiline_frame&&!k.keep_array_indentation&&F(),f.multiline_frame&&j(),k.space_in_paren&&(o==="TK_START_EXPR"?(M(),E=!1):E=!0),i==="]"&&k.keep_array_indentation?(U(),K()):(K(),U()),X(l),f.do_while&&l.mode===C.Conditional&&(l.mode=C.Expression,f.do_block=!1,f.do_while=!1)}function ot(){V(C.BlockStatement);var e=nt("}"),t=e&&f.last_word==="function"&&o==="TK_END_EXPR";k.brace_style==="expand"?o!=="TK_OPERATOR"&&(t||o==="TK_EQUALS"||Z(f.last_text)&&f.last_text!=="else")?E=!0:F():o!=="TK_OPERATOR"&&o!=="TK_START_EXPR"?o==="TK_START_BLOCK"?F():E=!0:$(l.mode)&&f.last_text===","&&(u==="}"?E=!0:F()),U(),z()}function ut(){while(f.mode===C.Statement)K();var e=o==="TK_START_BLOCK";k.brace_style==="expand"?e||F():e||($(f.mode)&&k.keep_array_indentation?(k.keep_array_indentation=!1,F(),k.keep_array_indentation=!0):F()),K(),U()}function at(){G()||b&&!J(f.mode)&&(o!=="TK_OPERATOR"||f.last_text==="--"||f.last_text==="++")&&o!=="TK_EQUALS"&&(k.preserve_newlines||f.last_text!=="var")&&F();if(f.do_block&&!f.do_while){if(i==="while"){E=!0,U(),E=!0,f.do_while=!0;return}F(),f.do_block=!1}if(f.if_block&&i!=="else"){while(f.mode===C.Statement)K();f.if_block=!1}if(i==="case"||i==="default"&&f.in_case_statement){F();if(f.case_body||k.jslint_happy)W(),f.case_body=!1;U(),f.in_case=!0,f.in_case_statement=!0;return}i==="function"&&(f.var_line&&o!=="TK_EQUALS"&&(f.var_line_reindented=!0),(H()||f.last_text===";"||f.last_text==="}")&&f.last_text!=="{"&&!$(f.mode)&&(B()||(F(),F(!0))),o==="TK_WORD"?f.last_text==="get"||f.last_text==="set"||f.last_text==="new"||f.last_text==="return"?E=!0:F():o==="TK_OPERATOR"||f.last_text==="="?E=!0:J(f.mode)||F());if(o==="TK_COMMA"||o==="TK_START_EXPR"||o==="TK_EQUALS"||o==="TK_OPERATOR")Q()||j();if(i==="function"){U(),f.last_word=i;return}y="NONE",o==="TK_END_BLOCK"?et(i,["else","catch","finally"])?k.brace_style==="expand"||k.brace_style==="end-expand"?y="NEWLINE":(y="SPACE",E=!0):y="NEWLINE":o==="TK_SEMICOLON"&&f.mode===C.BlockStatement?y="NEWLINE":o==="TK_SEMICOLON"&&J(f.mode)?y="SPACE":o==="TK_STRING"?y="NEWLINE":o==="TK_WORD"?y="SPACE":o==="TK_START_BLOCK"?y="NEWLINE":o==="TK_END_EXPR"&&(E=!0,y="NEWLINE"),et(i,m)&&f.last_text!==")"&&(f.last_text==="else"?y="SPACE":y="NEWLINE");if(et(i,["else","catch","finally"]))if(o!=="TK_END_BLOCK"||k.brace_style==="expand"||k.brace_style==="end-expand")F();else{M(!0);var e=r[r.length-1];e.text[e.text.length-1]!=="}"&&F(),E=!0}else y==="NEWLINE"?Z(f.last_text)?E=!0:o!=="TK_END_EXPR"?(o!=="TK_START_EXPR"||i!=="var")&&f.last_text!==":"&&(i==="if"&&f.last_word==="else"&&f.last_text!=="{"?E=!0:(f.var_line=!1,f.var_line_reindented=!1,F())):et(i,m)&&f.last_text!==")"&&(f.var_line=!1,f.var_line_reindented=!1,F()):$(f.mode)&&f.last_text===","&&u==="}"?F():y==="SPACE"&&(E=!0);U(),f.last_word=i,i==="var"&&(f.var_line=!0,f.var_line_reindented=!1,f.var_line_tainted=!1),i==="do"&&(f.do_block=!0),i==="if"&&(f.if_block=!0)}function ft(){G()&&(E=!1);while(f.mode===C.Statement&&!f.if_block&&!f.do_block)K();U(),f.var_line=!1,f.var_line_reindented=!1,f.mode===C.ObjectLiteral&&(f.mode=C.BlockStatement)}function lt(){G()?E=!0:o==="TK_WORD"?E=!0:o==="TK_COMMA"||o==="TK_START_EXPR"||o==="TK_EQUALS"||o==="TK_OPERATOR"?Q()||j():F(),U()}function ct(){f.var_line&&(f.var_line_tainted=!0),E=!0,U(),E=!0}function ht(){if(f.var_line){if(J(f.mode)||o==="TK_END_BLOCK")f.var_line_tainted=!1;f.var_line&&(f.var_line_reindented=!0),U(),f.var_line_tainted?(f.var_line_tainted=!1,F()):E=!0;return}o==="TK_END_BLOCK"&&f.mode!==C.Expression?(U(),f.mode===C.ObjectLiteral&&f.last_text==="}"?F():E=!0):f.mode===C.ObjectLiteral?(U(),F()):(U(),E=!0)}function pt(){var e=!0,t=!0;if(Z(f.last_text)){E=!0,U();return}if(i==="*"&&o==="TK_DOT"&&!u.match(/^\d+$/)){U();return}if(i===":"&&f.in_case){f.case_body=!0,z(),U(),F(),f.in_case=!1;return}if(i==="::"){U();return}b&&(i==="--"||i==="++")&&F(),et(i,["--","++","!"])||et(i,["-","+"])&&(et(o,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||et(f.last_text,m)||f.last_text===",")?(e=!1,t=!1,f.last_text===";"&&J(f.mode)&&(e=!0),o==="TK_WORD"&&et(f.last_text,m)&&(e=!0),(f.mode===C.BlockStatement||f.mode===C.Statement)&&(f.last_text==="{"||f.last_text===";")&&F()):i===":"?f.ternary_depth===0?(f.mode===C.BlockStatement&&(f.mode=C.ObjectLiteral),e=!1):f.ternary_depth-=1:i==="?"&&(f.ternary_depth+=1),E=E||e,U(),E=t}function dt(){var e=P(i),t,n=!1;F(!1,!0),e.length>1&&Y(e.slice(1),"*")&&(n=!0),U(e[0]);for(t=1;t<e.length;t++)F(!1,!0),n?U(" "+D(e[t])):r[r.length-1].text.push(e[t]);F(!1,!0)}function vt(){E=!0,U(),E=!0}function mt(){b?F(!1,!0):M(!0),E=!0,U(),F(!1,!0)}function gt(){Z(f.last_text)?E=!0:j(f.last_text===")"&&k.break_chained_methods),U()}function yt(){U(),i[i.length-1]==="\n"&&F()}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L="";h="\n\r	 ".split(""),p="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),g="0123456789".split(""),d="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::",d+=" <%= <% %> <?= <? ?>",d=d.split(" "),m="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(","),C={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"},N={TK_START_EXPR:it,TK_END_EXPR:st,TK_START_BLOCK:ot,TK_END_BLOCK:ut,TK_WORD:at,TK_SEMICOLON:ft,TK_STRING:lt,TK_EQUALS:ct,TK_OPERATOR:pt,TK_COMMA:ht,TK_BLOCK_COMMENT:dt,TK_INLINE_COMMENT:vt,TK_COMMENT:mt,TK_DOT:gt,TK_UNKNOWN:yt},t=t?t:{},k={},t.space_after_anon_function!==undefined&&t.jslint_happy===undefined&&(t.jslint_happy=t.space_after_anon_function),t.braces_on_own_line!==undefined&&(k.brace_style=t.braces_on_own_line?"expand":"collapse"),k.brace_style=t.brace_style?t.brace_style:k.brace_style?k.brace_style:"collapse",k.brace_style==="expand-strict"&&(k.brace_style="expand"),k.indent_size=t.indent_size?parseInt(t.indent_size,10):4,k.indent_char=t.indent_char?t.indent_char:" ",k.preserve_newlines=t.preserve_newlines===undefined?!0:t.preserve_newlines,k.break_chained_methods=t.break_chained_methods===undefined?!1:t.break_chained_methods,k.max_preserve_newlines=t.max_preserve_newlines===undefined?0:parseInt(t.max_preserve_newlines,10),k.space_in_paren=t.space_in_paren===undefined?!1:t.space_in_paren,k.jslint_happy=t.jslint_happy===undefined?!1:t.jslint_happy,k.keep_array_indentation=t.keep_array_indentation===undefined?!1:t.keep_array_indentation,k.space_before_conditional=t.space_before_conditional===undefined?!0:t.space_before_conditional,k.unescape_strings=t.unescape_strings===undefined?!1:t.unescape_strings,k.wrap_line_length=t.wrap_line_length===undefined?0:parseInt(t.wrap_line_length,10),k.e4x=t.e4x===undefined?!1:t.e4x,t.indent_with_tabs&&(k.indent_char="	",k.indent_size=1),a="";while(k.indent_size>0)a+=k.indent_char,k.indent_size-=1;while(e&&(e.charAt(0)===" "||e.charAt(0)==="	"))L+=e.charAt(0),e=e.substring(1);n=e,S=e.length,o="TK_START_BLOCK",u="",r=[O()],w=!1,E=!1,T=[],c=[],V(C.BlockStatement),v=0,this.beautify=function(){var e,t,n,a;for(;;){e=rt(),i=e[0],s=e[1];if(s==="TK_EOF")break;n=k.keep_array_indentation&&$(f.mode),b=x>0;if(n)for(t=0;t<x;t+=1)F(t>0);else{k.max_preserve_newlines&&x>k.max_preserve_newlines&&(x=k.max_preserve_newlines);if(k.preserve_newlines&&x>1){F();for(t=1;t<x;t+=1)F(!0)}}N[s](),s!=="TK_INLINE_COMMENT"&&s!=="TK_COMMENT"&&s!=="TK_UNKNOWN"&&(u=f.last_text,o=s,f.last_text=i)}a=r[0].text.join("");for(var l=1;l<r.length;l++)a+="\n"+r[l].text.join("");return a=a.replace(/[\r\n ]+$/,""),a}}typeof define=="function"?typeof define.amd=="undefined"?define("ecma-unparse/beautify",["require","exports","module"],function(t,n,r){n.js_beautify=e}):define("ecma-unparse/beautify",[],function(){return e}):typeof exports!="undefined"?exports.js_beautify=e:typeof window!="undefined"?window.js_beautify=e:typeof global!="undefined"&&(global.js_beautify=e)}(),define("ecma-unparse/print",["require","exports","nu-stream/stream","./beautify"],function(e,t,n,r){var i=n.foldl,s=n.map,o,u=i.bind(null,function(e,t){return e+t},""),a=s.bind(null,function(e){if(!e)return"";switch(e.type){case"Null":return"null";case"Comment":return"/*"+e.value+"*/";case"String":return JSON.stringify(e.value).replace("\u2028","\\u2028").replace("\u2029","\\u2029");default:return e.value}}),f={preserve_newlines:!1,wrap_line_length:120,break_chained_methods:!0},l=r.js_beautify||r;o=function(e,t){return function(n){return e(t(n))}}(function(e){return l(e,f)},function(e,t){return function(n){return e(t(n))}}(u,a)),t.print=o}),require(["nu-stream/stream","khepri/lex/lexer","khepri/parse/parser","khepri/compile/transform","khepri/compile/lexical","khepri/compile/compile","ecma-unparse/unparse","ecma-unparse/print"],function(e,t,n,r,i,s,o,u){var a=CodeMirror.fromTextArea(document.getElementById("khepri-console-input"),{mode:"javascript",lineNumbers:!0}),f=CodeMirror.fromTextArea(document.getElementById("javascript-console-output"),{mode:"javascript",lineNumbers:!0,readOnly:!0}),l=function(e){$("#text-out").text("");var r={package_manager:$("#package_manager").val()};try{var i=t.lex(e),a=n.parseStream(i),l=s.compile(a,r),c=o.unparse(l),h=u.print(c);return f.doc.setValue(h),$("#text-out").removeClass("error"),h}catch(p){$("#text-out").addClass("error").text(p)}};$(function(){$("#translate-button").click(function(){l(a.doc.getValue("\n"))})})}),define("javascripts/console.js",function(){});